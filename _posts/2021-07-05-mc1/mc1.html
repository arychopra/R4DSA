<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>The Vast Challenge</title>
  
  <meta property="description" itemprop="description" content="Mini Challenge 1"/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-07-05"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-07-05"/>
  <meta name="article:author" content="Aryah U. Chopra"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="The Vast Challenge"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Mini Challenge 1"/>
  <meta property="og:locale" content="en_US"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="The Vast Challenge"/>
  <meta property="twitter:description" content="Mini Challenge 1"/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["The Vast Challenge"]},{"type":"character","attributes":{},"value":["Mini Challenge 1\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Aryah U. Chopra"]},{"type":"character","attributes":{},"value":["https://www.linkedin.com/in/aryahuc/"]}]}]},{"type":"character","attributes":{},"value":["07-05-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["english-ewt-ud-2.5-191206.udpipe","images/3-1-0.png","images/3-1-1.png","images/3-1-10.png","images/3-1-11.png","images/3-1-12.png","images/3-1-13.png","images/3-1-14.png","images/3-1-2.png","images/3-1-3.png","images/3-1-4.png","images/3-1-5.png","images/3-1-6.png","images/3-1-7.png","images/3-1-8.png","images/3-1-9.png","images/5-1-1.png","images/5-1-10.png","images/5-1-11.png","images/5-1-12.png","images/5-1-13.png","images/5-1-14.png","images/5-1-2.png","images/5-1-3.png","images/5-1-4.png","images/5-1-5.png","images/5-1-6-1.png","images/5-1-6-2.png","images/5-1-6-3.png","images/5-1-6-4.png","images/5-1-6-5.png","images/5-1-6.png","images/5-1-7.png","images/5-1-8.png","images/5-1-9.png","MC1_data/df_news.csv","MC1_data/email headers.csv","MC1_data/EmployeeRecords.xlsx","mc1_files/anchor-4.2.2/anchor.min.js","mc1_files/bootstrap-3.3.2/css/bootstrap-theme.css","mc1_files/bootstrap-3.3.2/css/bootstrap-theme.css.map","mc1_files/bootstrap-3.3.2/css/bootstrap-theme.min.css","mc1_files/bootstrap-3.3.2/css/bootstrap-theme.min.css.map","mc1_files/bootstrap-3.3.2/css/bootstrap.css","mc1_files/bootstrap-3.3.2/css/bootstrap.css.map","mc1_files/bootstrap-3.3.2/css/bootstrap.min.css","mc1_files/bootstrap-3.3.2/css/bootstrap.min.css.map","mc1_files/bootstrap-3.3.2/fonts/glyphicons-halflings-regular.eot","mc1_files/bootstrap-3.3.2/fonts/glyphicons-halflings-regular.svg","mc1_files/bootstrap-3.3.2/fonts/glyphicons-halflings-regular.ttf","mc1_files/bootstrap-3.3.2/fonts/glyphicons-halflings-regular.woff","mc1_files/bootstrap-3.3.2/fonts/glyphicons-halflings-regular.woff2","mc1_files/bootstrap-3.3.2/js/bootstrap.js","mc1_files/bootstrap-3.3.2/js/bootstrap.min.js","mc1_files/bootstrap-3.3.2/js/npm.js","mc1_files/bootstrap-3.3.2/shim/html5shiv.min.js","mc1_files/bootstrap-3.3.2/shim/respond.min.js","mc1_files/bowser-1.9.3/bowser.min.js","mc1_files/crosstalk-1.1.1/css/crosstalk.css","mc1_files/crosstalk-1.1.1/js/crosstalk.js","mc1_files/crosstalk-1.1.1/js/crosstalk.js.map","mc1_files/crosstalk-1.1.1/js/crosstalk.min.js","mc1_files/crosstalk-1.1.1/js/crosstalk.min.js.map","mc1_files/d3-4.5.0/d3.min.js","mc1_files/d3-4.5.0/LICENSE","mc1_files/distill-2.2.21/template.v2.js","mc1_files/figure-html5/unnamed-chunk-34-1.png","mc1_files/figure-html5/unnamed-chunk-35-1.png","mc1_files/figure-html5/unnamed-chunk-36-1.png","mc1_files/figure-html5/unnamed-chunk-40-1.png","mc1_files/figure-html5/unnamed-chunk-40-2.png","mc1_files/figure-html5/unnamed-chunk-40-3.png","mc1_files/figure-html5/unnamed-chunk-40-4.png","mc1_files/figure-html5/unnamed-chunk-40-5.png","mc1_files/figure-html5/unnamed-chunk-41-1.png","mc1_files/figure-html5/unnamed-chunk-41-2.png","mc1_files/figure-html5/unnamed-chunk-41-3.png","mc1_files/figure-html5/unnamed-chunk-41-4.png","mc1_files/figure-html5/unnamed-chunk-42-1.png","mc1_files/figure-html5/unnamed-chunk-43-1.png","mc1_files/figure-html5/unnamed-chunk-44-1.png","mc1_files/figure-html5/unnamed-chunk-45-1.png","mc1_files/figure-html5/unnamed-chunk-46-1.png","mc1_files/figure-html5/unnamed-chunk-47-1.png","mc1_files/figure-html5/unnamed-chunk-49-1.png","mc1_files/figure-html5/words-1.png","mc1_files/forceNetwork-binding-0.4/forceNetwork.js","mc1_files/htmlwidgets-1.5.3/htmlwidgets.js","mc1_files/jquery-1.11.3/jquery.min.js","mc1_files/jquery-3.5.1/jquery-AUTHORS.txt","mc1_files/jquery-3.5.1/jquery.js","mc1_files/jquery-3.5.1/jquery.min.js","mc1_files/jquery-3.5.1/jquery.min.map","mc1_files/plotly-binding-4.9.3/plotly.js","mc1_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css","mc1_files/plotly-main-1.57.1/plotly-latest.min.js","mc1_files/popper-2.6.0/popper.min.js","mc1_files/selectize-0.11.2/css/selectize.bootstrap3.css","mc1_files/selectize-0.11.2/js/es5-shim.min.js","mc1_files/selectize-0.11.2/js/selectize.min.js","mc1_files/tippy-6.2.7/tippy-bundle.umd.min.js","mc1_files/tippy-6.2.7/tippy-light-border.css","mc1_files/tippy-6.2.7/tippy.css","mc1_files/tippy-6.2.7/tippy.umd.min.js","mc1_files/typedarray-0.1/typedarray.min.js","mc1_files/vis-4.20.1/img/network/acceptDeleteIcon.png","mc1_files/vis-4.20.1/img/network/addNodeIcon.png","mc1_files/vis-4.20.1/img/network/backIcon.png","mc1_files/vis-4.20.1/img/network/connectIcon.png","mc1_files/vis-4.20.1/img/network/cross.png","mc1_files/vis-4.20.1/img/network/cross2.png","mc1_files/vis-4.20.1/img/network/deleteIcon.png","mc1_files/vis-4.20.1/img/network/downArrow.png","mc1_files/vis-4.20.1/img/network/editIcon.png","mc1_files/vis-4.20.1/img/network/leftArrow.png","mc1_files/vis-4.20.1/img/network/minus.png","mc1_files/vis-4.20.1/img/network/plus.png","mc1_files/vis-4.20.1/img/network/rightArrow.png","mc1_files/vis-4.20.1/img/network/upArrow.png","mc1_files/vis-4.20.1/img/network/zoomExtends.png","mc1_files/vis-4.20.1/vis.css","mc1_files/vis-4.20.1/vis.min.js","mc1_files/visNetwork-binding-2.0.9/visNetwork.js","mc1_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }
  
  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }
  
  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }
  
  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }
  
  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }
  
  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }
  
  d-article h3 {
    margin-top: 1.5rem;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  /* Tweak code blocks */
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }
  
  d-article div.sourceCode {
    background-color: white;
  }
  
  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  d-article pre a {
    border-bottom: none;
  }
  
  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }
  
  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }
  
  @media(min-width: 768px) {
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }
  
  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }
  
  d-article pre {
    font-size: 14px;
  }
  
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for d-contents */
  
  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }
  
  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }
  
  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .d-contents li {
    list-style-type: none
  }
  
  .d-contents nav > ul {
    padding-left: 0;
  }
  
  .d-contents ul {
    padding-left: 1em
  }
  
  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }
  
  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }
  
  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }
  
  .d-contents nav > ul > li > a {
    font-weight: 600;
  }
  
  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }
  
  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }
  
  
  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }
  
  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }
  
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  /* Citations */
  
  d-article .citation {
    color: inherit;
    cursor: inherit;
  }
  
  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }
  
  /* Citation hover box */
  
  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }
  
  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  /* Include appendix styles here so they can be overridden */
  
  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }
  
  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }
  
  d-appendix h3 + * {
    margin-top: 1em;
  }
  
  d-appendix ol {
    padding: 0 0 0 15px;
  }
  
  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }
  
  d-appendix li {
    margin-bottom: 1em;
  }
  
  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  d-appendix > * {
    grid-column: text;
  }
  
  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }
  
  /* Include footnote styles here so they can be overridden */
  
  d-footnote-list {
    contain: layout style;
  }
  
  d-footnote-list > * {
    grid-column: text;
  }
  
  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }
  
  
  
  /* Anchor.js */
  
  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }
  
  /* Styles for posts lists (not auto-injected) */
  
  
  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }
  
  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }
  
  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }
  
  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }
  
  .post-preview-last {
    border-bottom: none !important;
  }
  
  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }
  
  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }
  
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }
  
  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }
  
  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }
  
  .posts-list .metadata > * {
    display: inline-block;
  }
  
  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }
  
  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }
  
  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }
  
  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  .posts-list img {
    opacity: 1;
  }
  
  .posts-list img[data-src] {
    opacity: 0;
  }
  
  .posts-more {
    clear: both;
  }
  
  
  .posts-sidebar {
    font-size: 16px;
  }
  
  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }
  
  .sidebar-section {
    margin-bottom: 30px;
  }
  
  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  
  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }
  
  .categories li>a {
    border-bottom: none;
  }
  
  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }
  
  .categories .active {
    font-weight: 600;
  }
  
  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }
  
  
  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  .downlevel .posts-list .post-preview {
    color: inherit;
  }
  
  
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }
  
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();
  
    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-contents').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="mc1_files/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <link href="mc1_files/vis-4.20.1/vis.css" rel="stylesheet" />
  <script src="mc1_files/vis-4.20.1/vis.min.js"></script>
  <script src="mc1_files/visNetwork-binding-2.0.9/visNetwork.js"></script>
  <script src="mc1_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="mc1_files/popper-2.6.0/popper.min.js"></script>
  <link href="mc1_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="mc1_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="mc1_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="mc1_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="mc1_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="mc1_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="mc1_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"The Vast Challenge","description":"Mini Challenge 1","authors":[{"author":"Aryah U. Chopra","authorURL":"https://www.linkedin.com/in/aryahuc/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-05T00:00:00.000+08:00","citationText":"Chopra, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>The Vast Challenge</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Mini Challenge 1</p></p>
</div>

<div class="d-byline">
  Aryah U. Chopra <a href="https://www.linkedin.com/in/aryahuc/" class="uri">https://www.linkedin.com/in/aryahuc/</a> 
  
<br/>07-05-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">1 Introduction</a></li>
<li><a href="#literature-review">2 Literature Review</a></li>
<li><a href="#data-preparation">3 Data Preparation</a><ul>
<li><a href="#news-article-data">3.1 News Article Data</a></li>
<li><a href="#employee-emails">3.2 Employee Emails</a></li>
<li><a href="#employee-bio-data">3.3 Employee Bio-data</a></li>
</ul></li>
<li><a href="#building-the-visuals">4 Building the Visuals</a><ul>
<li><a href="#building-the-visuals-for-question-1">4.1 Building the Visuals for Question 1</a></li>
<li><a href="#building-the-visuals-for-question-2">4.2 Building the Visuals for Question 2</a></li>
<li><a href="#building-the-visuals-for-question-3">4.3 Building the Visuals for Question 3</a></li>
</ul></li>
<li><a href="#insights">5 Insights</a><ul>
<li><a href="#question-1">5.1 Question 1</a></li>
<li><a href="#question-2">5.2 Question 2</a></li>
<li><a href="#question-3">5.3 Question 3</a></li>
<li><a href="#question-4">5.4 Question 4</a></li>
</ul></li>
</ul>
</nav>
</div>
<style>

d-article div.sourceCode {
    background-color: rgba(247, 230, 230, 0.05);
    border-color: blue;
    border: 1px solid rgba(249, 83, 85, 0.2);
    border-radius: 1px;
    overflow-x: auto !important;
    max-width: 704px;

}

d-article pre{
    background-color: rgba(217, 217, 217, 0.05);
    #border: 1px solid rgba(217, 217, 217, 0.2);
    border-radius: 1px;
    overflow-x: auto !important;
    max-width: 704px;
}
.tooltip {
  position: relative;
  display: inline-block;
  border-bottom: 1px dotted black;
  background-color: white;
  border-color: coral;
}

.tooltip .tooltiptext {
  visibility: visible;
  width: auto;
  background-color: white;
  color: #000000;
  text-align: center;
  border-radius: 6px;
  padding: 5px 0;
  position: absolute;
  z-index: 1;
  bottom: 150%;
  left: 50%;
  margin-left: -60px;
}

</style>
<div class="layout-chunk" data-layout="l-body">
<style type="text/css">
body {line-height: 1;}
</style>
</div>
<div class="layout-chunk" data-layout="l-body">
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"
</style>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">
 $(document).ready(function() {
    $('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');
    // onClick function for all plots (img's)
    $('img:not(.zoomImg)').click(function() {
      $('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
      $('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
    });
    // onClick function for zoomImg
    $('img.zoomImg').click(function() {
      $('.zoomDiv').css({opacity: '0', width: '0%'}); 
    });
  });
</script>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="introduction">1 Introduction</h2>
<h2 id="literature-review">2 Literature Review</h2>
<h2 id="data-preparation">3 Data Preparation</h2>
<p>The MC1 has the following data/documents:</p>
<ul>
<li>Historical Documents</li>
<li>News Articles</li>
<li>Resumes (Word documents)</li>
<li>Email Headers (CSV File)</li>
<li>Employee Records (XLSX File)</li>
<li>Factbook - Kronos (Word document)</li>
<li>Factbook - Tethys (Word document)</li>
<li>GAStech Kronos Organization Chart (PDF Image)</li>
<li>Map of Krono (Image)</li>
</ul>
<h3 id="news-article-data">3.1 News Article Data</h3>
<p>First, we will load the following libraries for the data clean:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://lubridate.tidyverse.org'>lubridate</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rstudio/DT'>DT</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="merging-the-new-articles">3.1.1 Merging the New Articles</h4>
<p>The MC1 folder contains a folder <code>News Articles</code>. Within it are subfolders containing the 29 different news sources, within which are articles in a text format.</p>
<p>We will merge all of the new article’s contents into a tidy format for text processing later, this means that each row will represent one observation and each column, one variable.</p>
<p>The text file have been tagged as such:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-0.png" width="250" /></p>
</div>
<p>Running the following code chunk will give us the combined data:</p>
<a id="first_chunk"></a>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>curr_dir</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>'MC1/News Articles/'</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>df.news</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>counter</span> <span class='op'>=</span> <span class='fl'>1</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>folder</span> <span class='kw'>in</span> <span class='va'>curr_dir</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>files_in_curr_dir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'MC1/News Articles/'</span>, <span class='va'>folder</span>,
                                                 <span class='st'>'/'</span>, sep<span class='op'>=</span><span class='st'>''</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='co'>#print(files_in_curr_dir)</span>

  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>file</span> <span class='kw'>in</span> <span class='va'>files_in_curr_dir</span><span class='op'>)</span><span class='op'>{</span>
      <span class='va'>vector</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
      <span class='va'>chunk_text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
      
      <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'MC1/News Articles/'</span>, <span class='va'>folder</span>,
                                          <span class='st'>'/'</span>, <span class='va'>file</span>, sep <span class='op'>=</span> <span class='st'>''</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
        <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"SOURCE:|LOCATION:|AUTHOR:|PUBLISHED:|TITLE:|NOTE:"</span>, <span class='va'>i</span>, 
                  fixed <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
          <span class='va'>vector</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>vector</span>,<span class='op'>(</span><span class='va'>i</span><span class='op'>)</span><span class='op'>)</span>
        <span class='op'>}</span> <span class='kw'>else</span> <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"\\S+"</span>,<span class='va'>i</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
          <span class='va'>chunk_text</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>chunk_text</span>,<span class='va'>i</span><span class='op'>)</span>
        <span class='op'>}</span>
      <span class='op'>}</span>
      
      <span class='va'>chunk_text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/capture.output.html'>capture.output</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='va'>chunk_text</span><span class='op'>)</span><span class='op'>)</span>
      <span class='va'>chunk_text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"TEXT:"</span>, <span class='va'>chunk_text</span><span class='op'>)</span>
      <span class='va'>fileName</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"FILE:"</span>,<span class='va'>file</span><span class='op'>)</span><span class='op'>)</span>
      <span class='va'>article</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>fileName</span>,<span class='va'>vector</span>,<span class='va'>chunk_text</span><span class='op'>)</span>

      
      <span class='va'>textlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>article</span><span class='op'>)</span>,
                         <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
                           caseno<span class='op'>=</span><span class='va'>counter</span>,
                           rawdata<span class='op'>=</span><span class='va'>article</span><span class='op'>[[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>]</span>,
                           stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
      
      <span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>rbind</span>, <span class='va'>textlist</span><span class='op'>)</span>
      <span class='va'>df</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"type"</span>,<span class='st'>"entry"</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='fu'>str_split_fixed</span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>rawdata</span>,<span class='st'>":"</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
      <span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>df</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"caseno"</span>,<span class='st'>"type"</span>,<span class='st'>"entry"</span><span class='op'>)</span><span class='op'>]</span>
      <span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'>pivot_wider</span><span class='op'>(</span><span class='va'>df</span>,
                        names_from <span class='op'>=</span> <span class='va'>type</span>,
                        values_from <span class='op'>=</span> <span class='va'>entry</span><span class='op'>)</span>
      
      <span class='va'>df.news</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>df.news</span>,<span class='va'>df</span><span class='op'>)</span>
      <span class='co'>#print(paste(folder,file))</span>
      
      <span class='va'>counter</span> <span class='op'>&lt;-</span> <span class='va'>counter</span> <span class='op'>+</span> <span class='fl'>1</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>When running the above code chunk, the for-loop will be interrupted multiple times due to the following error:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-1.png" width="250" /></p>
</div>
<p>During the run of the code, we can check which file gives us the error by looking at the <code>Global Environment</code> section of the RStudio window as shown below:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-2.png" width="250" /></p>
</div>
<p>This tells us that the interrupting file is <code>37.txt</code> in the <code>Central Bulletin</code> folder.</p>
<p>This error is a result of errored placement of the tags within the file. Opening up the file shown above we can see that there are multiple tags. As such, there is an attempt to concatenate a list and character, which is not possible.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-3.png" width="250" /></p>
</div>
<p>Upon running the entire code, the files that have the errors have been identified as:</p>
<ul>
<li>37.txt – Central Bulletin</li>
<li>791.txt – Daily Pegasus</li>
<li>188.txt – News Online Today</li>
<li>52.txt – News Online Today</li>
<li>570.txt – News Online Today</li>
<li>36.txt – The Continent</li>
<li>127.txt – The Explainer</li>
<li>205.txt – The Explainer</li>
</ul>
<p>Out of 845 files, there are 8 such files with error. Since there is a small number, we will edit ourselves.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-4.png" width="740" /></p>
</div>
<p>Once the files have been edited, re-run the <a href="#first_chunk">first code chunk</a> to get the final merged dataframe, <code>df.news</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-5.png" width="250" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>The dataframe, df.news, contains 845 observations of 9 variables, this tallies with the 845 news articles.</p>
<p>The columns <code>caseno</code> can be dropping using the following code:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
            <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>caseno</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="editing-the-published-column">3.1.2 Editing the PUBLISHED column</h4>
<p>The <code>PUBLISHED</code> column is not on in a date-time format. In addition to that, we can see that the <code>PUBLISHED</code> column has some odd entries.</p>
<p>Running the following code chunk, we can see that the total count of anomalies is 42 that are not in a date format that can be parsed (either <code>yyyy/mm/dd</code> or <code>dd Month yyyy</code>) by the <code>lubridate</code> library.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># This code tells us the total count of anomalies identified</span>
<span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
        <span class='fu'>select</span><span class='op'>(</span><span class='va'>FILE</span>, <span class='va'>SOURCE</span>, <span class='va'>PUBLISHED</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>PUBLISHED</span>,<span class='st'>"/"</span>,negate<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>      
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>PUBLISHED</span>,<span class='st'>"\\d+\\s\\w+\\s\\d+"</span>, negate <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>summarise</span><span class='op'>(</span><span class='st'>"Total Count of Anomalies"</span> <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># This code tells us identifies the no of each error encountered</span>
<span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
        <span class='fu'>select</span><span class='op'>(</span><span class='va'>FILE</span>, <span class='va'>SOURCE</span>, <span class='va'>PUBLISHED</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>PUBLISHED</span>,<span class='st'>"/"</span>,negate<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>      
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>PUBLISHED</span>,<span class='st'>"\\d+\\s\\w+\\s\\d+"</span>, negate <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>count</span><span class='op'>(</span><span class='st'>"Type of Error"</span> <span class='op'>=</span> <span class='va'>PUBLISHED</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
        <span class='fu'>rename</span><span class='op'>(</span>Count <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The output will look like so:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-6.png" width="200" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-7.png" width="250" /></p>
</div>
<p>This is similar to the errors encountered during the merging of the articles, as the tags were probably wrongly placed. In addition to that, there are dates that are in different formats.</p>
<p>In order to see which files the errors occur in:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
        <span class='fu'>select</span><span class='op'>(</span><span class='va'>FILE</span>, <span class='va'>SOURCE</span>, <span class='va'>PUBLISHED</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>PUBLISHED</span>,<span class='st'>"/"</span>,negate<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>      
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>PUBLISHED</span>,<span class='st'>"\\d+\\s\\w+\\s\\d+"</span>, negate <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The output will look like so:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-8.png" width="398" /></p>
</div>
<p>In addition to that, another file was noted to have error: <code>167.txt</code> in the <code>INTERNATIONAL TIMES</code>.</p>
<p>Like earlier, we will manually edit the files and then re run the <a href="#first_chunk">first code chunk</a>.</p>
<p>The PUBLISHED column will then be changed into a date-time format shown below.</p>
<p>First, we will check if any cannot be parsed with the following code.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>%&gt;%</span>
        <span class='fu'>mutate</span><span class='op'>(</span>PUBLISHED <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/parse_date_time.html'>parse_date_time</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span>, orders <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"%y%m%d"</span>,<span class='st'>"%d%m%y"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
        <span class='fu'>select</span><span class='op'>(</span><span class='va'>FILE</span>, <span class='va'>SOURCE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>If the output is 0 rows, then we can assign it with the following code:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span>
            <span class='fu'>mutate</span><span class='op'>(</span>PUBLISHED <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/parse_date_time.html'>parse_date_time</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span>, orders <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"%y%m%d"</span>, <span class='st'>"%d%m%y"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>All of the <code>PUBLISHED</code> column is in date-time format <code>yyyy-mm-dd</code>.</p>
<h4 id="editing-the-author-column">3.1.3 Editing the AUTHOR column</h4>
<p>Running the following code chunk, we can see that <code>By Haneson Ngohebo</code> is separated due to the “by”.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>AUTHOR</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 11 x 1
   AUTHOR                        
   &lt;chr&gt;                         
 1 &lt;NA&gt;                          
 2 Petrus Gerhard                
 3 By Haneson Ngohebo            
 4 Maha Salo                     
 5 Marcella Trapani              
 6 Cato Rossini, Marcella Trapani
 7 Cato Rossini                  
 8 Eva Thayer                    
 9 Lelio Masin                   
10 Donato Petri                  
11 Haneson Ngohebo               </code></pre>
</div>
<p>Hence, we will remove all prefixes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
            <span class='fu'>mutate</span><span class='op'>(</span>AUTHOR <span class='op'>=</span> <span class='fu'>str_remove</span><span class='op'>(</span><span class='va'>AUTHOR</span>, <span class='st'>"By "</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>df.news</span> <span class='op'>%&gt;%</span> <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>AUTHOR</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 10 x 1
   AUTHOR                        
   &lt;chr&gt;                         
 1 &lt;NA&gt;                          
 2 Petrus Gerhard                
 3 Haneson Ngohebo               
 4 Maha Salo                     
 5 Marcella Trapani              
 6 Cato Rossini, Marcella Trapani
 7 Cato Rossini                  
 8 Eva Thayer                    
 9 Lelio Masin                   
10 Donato Petri                  </code></pre>
</div>
<h4 id="editing-the-location-column">3.1.4 Editing the LOCATION column</h4>
<p>The <code>LOCATION</code> columns also contain a few errors that are due to the tag error.</p>
<p>Running the code below, we can get the error values</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>LOCATION <span class='op'>=</span> <span class='fu'>str_to_upper</span><span class='op'>(</span><span class='va'>LOCATION</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>LOCATION</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The output of the above code chunk will be:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-10.png" width="400" /></p>
</div>
<p>To identify and edit the files, the following code chunk will be applied:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>LOCATION <span class='op'>=</span> <span class='fu'>str_to_upper</span><span class='op'>(</span><span class='va'>LOCATION</span><span class='op'>)</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>LOCATION</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='st'>"ABILA, KRONOS"</span>,<span class='st'>"CENTRUM, TETHYS"</span>,<span class='st'>"DAVOS, SWITZERLAND"</span>,<span class='st'>"ELODIS, KRONOS"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The output of the above code chunk will be:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/3-1-11.png" width="400" /></p>
</div>
<p>Once all the files have been rectified, re run the <a href="#first_chunk">first code chunk</a>.<br> Change all the locations to upper case.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
            <span class='fu'>mutate</span><span class='op'>(</span>LOCATION <span class='op'>=</span> <span class='fu'>str_to_upper</span><span class='op'>(</span><span class='va'>LOCATION</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>TEXT</span>, <span class='st'>"[[:punct:]]"</span>, <span class='st'>" "</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="employee-emails">3.2 Employee Emails</h3>
<p>We will save the email conversation CSV as <code>df.emails</code> dataframe using the <code>readr</code> package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.emails</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>'MC1_data/email headers.csv'</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Running the following code chunk, we will remove all the email domains so that only the name is retained and also to convert the Date column into a datetime format.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.emails</span> <span class='op'>&lt;-</span> <span class='va'>df.emails</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>mutate</span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>To</span>,<span class='st'>"@gastech.com.kronos|@gastech.com.tethys"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'>mutate</span><span class='op'>(</span>From <span class='op'>=</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>From</span>,<span class='st'>"@gastech.com.kronos|@gastech.com.tethys"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'>mutate</span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>To</span>,<span class='st'>"[.]"</span>,<span class='st'>" "</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'>mutate</span><span class='op'>(</span>From <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>From</span>,<span class='st'>"[.]"</span>,<span class='st'>" "</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>mutate</span><span class='op'>(</span>Date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/parse_date_time.html'>parse_date_time</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Date</span>, orders <span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"%m%d%y %H%M"</span>,<span class='st'>"%m%d%y"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>  
</code></pre>
</div>
</div>
<p>We will also split the Date column into two columns, to retrieve the Date and Time</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.emails</span> <span class='op'>&lt;-</span> <span class='va'>df.emails</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>mutate</span><span class='op'>(</span>Date.Date <span class='op'>=</span>  <span class='fu'><a href='http://lubridate.tidyverse.org/reference/date.html'>date</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>mutate</span><span class='op'>(</span>Date.Time <span class='op'>=</span>  <span class='fu'>hms</span><span class='fu'>::</span><span class='fu'><a href='https://hms.tidyverse.org/reference/hms.html'>as_hms</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.emails</span> <span class='op'>&lt;-</span> <span class='va'>df.emails</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>nTo <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lengths.html'>lengths</a></span><span class='op'>(</span><span class='fu'>str_split</span><span class='op'>(</span><span class='va'>To</span>,pattern<span class='op'>=</span><span class='st'>","</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>nTo</span><span class='op'>&lt;=</span><span class='fl'>12</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="employee-bio-data">3.3 Employee Bio-data</h3>
<p>We will save the email conversation XLSX as <code>df.emp</code> dataframe using the <code>readxl</code> package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.emp</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_xlsx</a></span><span class='op'>(</span><span class='st'>'MC1_data/EmployeeRecords.xlsx'</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>A second column with their joined names will be created</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.emp</span> <span class='op'>&lt;-</span> <span class='va'>df.emp</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>unite</span><span class='op'>(</span><span class='va'>FullName</span>, <span class='va'>FirstName</span>, <span class='va'>LastName</span>, sep<span class='op'>=</span><span class='st'>" "</span>, remove<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="building-the-visuals">4 Building the Visuals</h2>
<p>The following libraries will be loaded:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://plotly-r.com'>plotly</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/cbail/textnets'>textnets</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/lepennec/ggwordcloud'>ggwordcloud</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/juliasilge/tidytext'>tidytext</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://datastorm-open.github.io/visNetwork/'>visNetwork</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/EmilHvitfeldt/textdata'>textdata</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://igraph.org'>igraph</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggraph.data-imaginist.com'>ggraph</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidygraph.data-imaginist.com'>tidygraph</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://kgjerde.github.io/corporaexplorer/'>corporaexplorer</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>topicmodels</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://github.com/dgrtwo/widyr'>widyr</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Corpora Explorer - To Analyse the Texts by Source</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>all_news_data</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"Date"</span><span class='op'>=</span><span class='st'>"PUBLISHED"</span><span class='op'>)</span>

<span class='va'>all_news_data</span><span class='op'>$</span><span class='va'>Text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>all_news_data</span><span class='op'>$</span><span class='va'>Date</span>, <span class='st'>"\n"</span>, 
                            <span class='va'>all_news_data</span><span class='op'>$</span><span class='va'>AUTHOR</span>, <span class='st'>"\n"</span>,
                            <span class='va'>all_news_data</span><span class='op'>$</span><span class='va'>NOTE</span>, <span class='st'>"\n"</span>, 
                            <span class='va'>all_news_data</span><span class='op'>$</span><span class='va'>Text</span><span class='op'>)</span>
<span class='va'>all_news_data</span> <span class='op'>&lt;-</span> <span class='va'>all_news_data</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Date</span><span class='op'>)</span>

<span class='va'>news_corpus</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://kgjerde.github.io/corporaexplorer/reference/prepare_data.html'>prepare_data</a></span><span class='op'>(</span>
                dataset <span class='op'>=</span> <span class='va'>all_news_data</span>,
                date_based_corpus <span class='op'>=</span> <span class='cn'>F</span>,
                grouping_variable <span class='op'>=</span> <span class='st'>"SOURCE"</span><span class='op'>)</span>

<span class='fu'><a href='https://kgjerde.github.io/corporaexplorer/reference/explore.html'>explore</a></span><span class='op'>(</span><span class='va'>news_corpus</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Corpora Explorer - To Analyse the Texts by Date</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>all_news_data_2</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                   <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"Date"</span><span class='op'>=</span><span class='st'>"PUBLISHED"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                   <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Date <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/date.html'>date</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>all_news_data_2</span><span class='op'>$</span><span class='va'>Text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>all_news_data_2</span><span class='op'>$</span><span class='va'>SOURCE</span>,<span class='st'>": \n"</span>, <span class='va'>all_news_data_2</span><span class='op'>$</span><span class='va'>AUTHOR</span>, <span class='st'>"\n"</span>, <span class='va'>all_news_data_2</span><span class='op'>$</span><span class='va'>Text</span><span class='op'>)</span>

<span class='va'>news_corpus_date</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://kgjerde.github.io/corporaexplorer/reference/prepare_data.html'>prepare_data</a></span><span class='op'>(</span>
                    dataset <span class='op'>=</span> <span class='va'>all_news_data_2</span>,
                    date_based_corpus <span class='op'>=</span> <span class='cn'>T</span>,
                    grouping_variable <span class='op'>=</span> <span class='st'>"SOURCE"</span><span class='op'>)</span>

<span class='fu'><a href='https://kgjerde.github.io/corporaexplorer/reference/explore.html'>explore</a></span><span class='op'>(</span><span class='va'>news_corpus_date</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Re-making the functions for building text visuals:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>VisTextNet_e</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>text_network</span>, <span class='va'>alpha</span> <span class='op'>=</span> <span class='fl'>.25</span>, <span class='va'>label_degree_cut</span><span class='op'>=</span><span class='fl'>0</span>, <span class='va'>betweenness</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/which_multiple.html'>has.multiple</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"textnets does not yet support multiple edges"</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>text_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/set_vertex_attr.html'>set_vertex_attr</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='st'>"name"</span>, value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='co'>#create network backbone </span>
  
  <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>as_data_frame</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span> <span class='op'>]</span>, 
             weight <span class='op'>=</span>   <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>
  
  <span class='co'># in</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_in</span><span class='op'>)</span>, <span class='va'>w_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>)</span>, <span class='va'>k_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_in</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_in <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_in</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># out</span>
  
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_out</span><span class='op'>)</span>, <span class='va'>w_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>)</span>, <span class='va'>k_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_out</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_out <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_out</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>e_in</span>, <span class='va'>e_out</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>, <span class='st'>"to"</span>, <span class='st'>"weight"</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>alpha_in</span> <span class='op'>&lt;</span> <span class='va'>alpha_out</span>, <span class='va'>alpha_in</span>, <span class='va'>alpha_out</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>alpha</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span><span class='op'>$</span><span class='va'>alpha</span>
  
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_edges.html'>delete.edges</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&gt;=</span> <span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
  
  
  <span class='co'># make degree for labelling most popular nodes</span>
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>
  
  <span class='co'># remove isolates</span>
  <span class='va'>isolates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>]</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='va'>isolates</span><span class='op'>)</span>
  
  <span class='co'># calculate modularity for coloring</span>
  <span class='va'>communities</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/cluster_louvain.html'>cluster_louvain</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>
  <span class='co'>#V(pruned)$modularity &lt;- communities$membership</span>
  <span class='co'>#print(communities$membership)</span>
  
  <span class='co'>#calculate betweenness for sizing nodes</span>
  <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fl'>25</span> <span class='co'>#default 25</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>betweenness</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/betweenness.html'>betweenness</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> 
    
    <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='va'>size</span><span class='op'>/</span><span class='fl'>0.95</span>
  <span class='op'>}</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>community</span> <span class='op'>&lt;-</span> <span class='va'>communities</span><span class='op'>$</span><span class='va'>membership</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>
  
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                      title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Degree of Node: &lt;br&gt;"</span>,
                                     <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span><span class='op'>)</span>,
                      group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>community</span>,
                      size <span class='op'>=</span>  <span class='va'>size</span>
                      <span class='op'>)</span>
  
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='va'>nodes</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>id</span>, decreasing <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>,<span class='op'>]</span>
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>shadow</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
  <span class='co'>#nodes$title &lt;- "black"</span>
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='va'>nodes</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>font.size <span class='op'>=</span> <span class='fl'>20</span>, font.weight<span class='op'>=</span> <span class='fl'>900</span><span class='op'>)</span>
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>

  <span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>pruned</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>
  <span class='va'>edges</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span>
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>

  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes</span>, <span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLayout.html'>visLayout</a></span><span class='op'>(</span>randomSeed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span>, 
               nodesIdSelection <span class='op'>=</span> <span class='cn'>TRUE</span>, 
               selectedBy <span class='op'>=</span> <span class='st'>"group"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>labelHighlightBold <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='co'>#visEdges(color=list(color = 'black', highlight = "brown")) %&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>TextComm_e</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>text_network</span>, <span class='va'>alpha</span> <span class='op'>=</span> <span class='fl'>.25</span>, <span class='va'>label_degree_cut</span><span class='op'>=</span><span class='fl'>0</span>, <span class='va'>betweenness</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/which_multiple.html'>has.multiple</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"textnets does not yet support multiple edges"</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>text_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/set_vertex_attr.html'>set_vertex_attr</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='st'>"name"</span>, value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='co'>#create network backbone </span>
  
  <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>as_data_frame</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span> <span class='op'>]</span>, 
             weight <span class='op'>=</span>   <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>
  
  <span class='co'># in</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_in</span><span class='op'>)</span>, <span class='va'>w_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>)</span>, <span class='va'>k_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_in</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_in <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_in</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># out</span>
  
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_out</span><span class='op'>)</span>, <span class='va'>w_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>)</span>, <span class='va'>k_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_out</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_out <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_out</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>e_in</span>, <span class='va'>e_out</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>, <span class='st'>"to"</span>, <span class='st'>"weight"</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>alpha_in</span> <span class='op'>&lt;</span> <span class='va'>alpha_out</span>, <span class='va'>alpha_in</span>, <span class='va'>alpha_out</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>alpha</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span><span class='op'>$</span><span class='va'>alpha</span>
  
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_edges.html'>delete.edges</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&gt;=</span> <span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
  
  
  <span class='co'># make degree for labelling most popular nodes</span>
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>
  
  <span class='co'># remove isolates</span>
  <span class='va'>isolates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>]</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='va'>isolates</span><span class='op'>)</span>
  
  <span class='co'># calculate modularity for coloring</span>
  <span class='va'>communities</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/cluster_louvain.html'>cluster_louvain</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>
  <span class='co'>#V(pruned)$modularity &lt;- communities$membership</span>
  <span class='co'>#print(communities$membership)</span>
  
  <span class='co'>#calculate betweenness for sizing nodes</span>
  <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fl'>25</span> <span class='co'>#default 25</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>betweenness</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/betweenness.html'>betweenness</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> 
    
    <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='va'>size</span><span class='op'>/</span><span class='fl'>0.95</span>
  <span class='op'>}</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>community</span> <span class='op'>&lt;-</span> <span class='va'>communities</span><span class='op'>$</span><span class='va'>membership</span>
  
  <span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>communities</span><span class='op'>$</span><span class='va'>names</span>, <span class='va'>communities</span><span class='op'>$</span><span class='va'>membership</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>output</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SOURCE"</span>,<span class='st'>"Membership"</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>output</span><span class='op'>)</span>

<span class='op'>}</span>
</code></pre>
</div>
</div>
<h3 id="building-the-visuals-for-question-1">4.1 Building the Visuals for Question 1</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>common_words</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>,<span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'>count</span><span class='op'>(</span><span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>&gt;</span><span class='fl'>200</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>lexicon <span class='op'>=</span> <span class='st'>"CUSTOM"</span><span class='op'>)</span>

<span class='va'>stop_words2</span> <span class='op'>&lt;-</span> <span class='va'>stop_words</span> <span class='op'>%&gt;%</span> 
                <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>common_words</span><span class='op'>)</span>


<span class='va'>clean_news_before</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                             <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>clean_news_2014</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Correlation Plot</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>clean_news_before_count</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                                   <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>newsgroup_cors</span> <span class='op'>&lt;-</span> <span class='va'>clean_news_before_count</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://rdrr.io/pkg/widyr/man/pairwise_cor.html'>pairwise_cor</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, 
                               <span class='va'>word</span>, 
                               <span class='va'>count</span>, 
                               sort <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>corr_plot_before</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>newsgroup_cors</span><span class='op'>)</span> <span class='op'>+</span>
                      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>item1</span>, y<span class='op'>=</span><span class='va'>item2</span>, fill<span class='op'>=</span><span class='va'>correlation</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
                      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, 
                                                       vjust <span class='op'>=</span> <span class='fl'>0.5</span>,
                                                       hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
                      <span class='fu'>paletteer</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/paletteer/man/ggplot2-scales-continuous.html'>scale_fill_paletteer_c</a></span><span class='op'>(</span><span class='st'>"viridis::plasma"</span><span class='op'>)</span> <span class='op'>+</span>
                      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>""</span>,
                           y<span class='op'>=</span><span class='st'>" "</span>, 
                           title <span class='op'>=</span> <span class='st'>"Correlations of New Sources from 1998 to 2014"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>clean_news_2014_count</span>      <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>2014</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/month.html'>month</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>newsgroup_cors_2014</span> <span class='op'>&lt;-</span> <span class='va'>clean_news_2014_count</span> <span class='op'>%&gt;%</span>
                        <span class='fu'><a href='https://rdrr.io/pkg/widyr/man/pairwise_cor.html'>pairwise_cor</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, 
                                     <span class='va'>word</span>, 
                                     <span class='va'>count</span>, 
                                     sort <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>corr_plot_2014</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>newsgroup_cors_2014</span><span class='op'>)</span> <span class='op'>+</span>
                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>item1</span>, y<span class='op'>=</span><span class='va'>item2</span>, fill<span class='op'>=</span><span class='va'>correlation</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, 
                                                   vjust <span class='op'>=</span> <span class='fl'>0.5</span>,
                                                   hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
                  <span class='fu'>paletteer</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/paletteer/man/ggplot2-scales-continuous.html'>scale_fill_paletteer_c</a></span><span class='op'>(</span><span class='st'>"viridis::plasma"</span><span class='op'>)</span> <span class='op'>+</span>
                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>""</span>,
                       y<span class='op'>=</span><span class='st'>" "</span>, 
                       title <span class='op'>=</span> <span class='st'>"Correlations of New Sources in 2014"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>text_grouped</span> <span class='op'>&lt;-</span> <span class='va'>clean_news_before</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span>

<span class='va'>news_before</span> <span class='op'>&lt;-</span> <span class='fu'>PrepText</span><span class='op'>(</span><span class='va'>text_grouped</span>, 
                         groupvar <span class='op'>=</span> <span class='st'>"SOURCE"</span>, 
                         textvar <span class='op'>=</span> <span class='st'>"word"</span>, 
                         node_type <span class='op'>=</span> <span class='st'>"groups"</span>, 
                         tokenizer <span class='op'>=</span> <span class='st'>"words"</span>, 
                         pos <span class='op'>=</span> <span class='st'>"nouns"</span>, 
                         remove_stop_words <span class='op'>=</span> <span class='cn'>TRUE</span>, 
                         compound_nouns <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>text_network_before</span> <span class='op'>&lt;-</span> <span class='fu'>CreateTextnet</span><span class='op'>(</span><span class='va'>news_before</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>390</span><span class='op'>)</span>
<span class='fu'>VisTextNet_e</span><span class='op'>(</span><span class='va'>text_network_before</span>, label_degree_cut <span class='op'>=</span> <span class='fl'>0</span>, betweenness <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> 
</code></pre>
</div>
<div id="htmlwidget-d93c111a3daed531e03c" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d93c111a3daed531e03c">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Central Bulletin","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","News Desk","News Online Today","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"title":["Degree of Node: <br>5","Degree of Node: <br>5","Degree of Node: <br>7","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>8","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>5","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>8","Degree of Node: <br>7","Degree of Node: <br>4","Degree of Node: <br>8","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>5"],"group":[1,3,3,1,4,1,2,4,2,3,1,3,4,3,5,2,5,1,2,5,5,1,5,4,4,2],"size":[14.7368421052632,2.10526315789474,2.10526315789474,0,0,2.10526315789474,29.4736842105263,0,0,25.2631578947368,83.1578947368421,17.8947368421053,31.5789473684211,32.6315789473684,13.6842105263158,8.42105263157895,0,0,43.1578947368421,53.6842105263158,0,74.7368421052632,0,0,21.0526315789474,5.26315789473684],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"font.weight":[900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["All News Today","Athena Speaks","Central Bulletin","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","News Desk","News Online Today","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"x":[-0.413761175849553,-1,-0.754743776151343,-0.894777761111636,1,-0.62915922904155,-0.196389908337728,0.334063384280372,-0.51046183137943,-0.656617509218177,-0.207283028509332,-0.959823895442572,0.840354250135174,-0.537692863170663,0.286728672107991,-0.291861776582472,0.482536470605055,-0.510557904769394,0.0493948362432457,0.0551223139353003,0.0535736527940964,-0.196839635332773,0.306725248222457,0.606557344721306,0.817036529703439,-0.0516218161900979],"y":[-0.423021301502743,0.728144874411058,0.486461224689636,-0.604813845854935,0.482437398270597,-0.64881363051593,0.663148561980747,0.224578953536622,0.732291966902484,0.188165393648341,0.132203793112386,0.0797990523754528,0.243178483468411,0.427977366364092,-0.576677921748198,1,-0.815662057776873,-0.878453892529442,0.42644987729886,-0.541042595251509,-0.897331679447066,-0.471187419594033,-1,0.169213655948973,-0.0957223970066993,0.924981384917807]},"edges":{"from":["All News Today","All News Today","All News Today","All News Today","All News Today","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Daily Pegasus","Daily Pegasus","Daily Pegasus","Everyday News","Everyday News","Everyday News","Everyday News","Homeland Illumination","Homeland Illumination","Homeland Illumination","International News","International News","International News","International News","International News","International Times","International Times","International Times","International Times","Kronos Star","Kronos Star","Kronos Star","Kronos Star","News Desk","News Desk","News Desk","News Desk","News Desk","News Online Today","News Online Today","The Abila Post","The Continent","The Continent","The Continent","The Continent","The Explainer","The Explainer","The General Post","The General Post","The General Post","The General Post","The Guide","The Guide","The Light of Truth","The Light of Truth","The Light of Truth","The Orb","The Truth","The Truth","The Truth","The Tulip","The Tulip","The Tulip","The World","World Journal"],"to":["Daily Pegasus","Homeland Illumination","News Online Today","The Orb","The Wrap","Central Bulletin","News Desk","The Abila Post","The Explainer","Worldwise","International News","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer","Homeland Illumination","The Orb","The Wrap","International Times","The Continent","World Journal","World Source","News Online Today","The Orb","The Wrap","Kronos Star","News Online Today","The Guide","The Truth","Worldwise","News Online Today","The Continent","World Journal","World Source","News Online Today","The Guide","The Truth","Worldwise","The Abila Post","The Explainer","The Truth","The Tulip","The Wrap","The Abila Post","World Source","The Explainer","The Truth","The Wrap","World Journal","World Source","The General Post","The Guide","The Light of Truth","The Tulip","The World","Who What News","The Truth","Worldwise","The Tulip","The World","Who What News","The Wrap","The Tulip","The Wrap","Worldwise","The World","The Wrap","Who What News","Who What News","World Source"],"value":[0.00156162744667993,0.00267032446242905,0.00115483769166408,0.00148798624872667,0.00139937938054064,0.00197286674383265,0.00184509822238823,0.00195494975427119,0.00170566986858221,0.00112080859457602,0.000987044946787035,0.000936701596860749,0.00189407573472961,0.00131782358430141,0.0049229392197231,0.00215577196461759,0.00165442260839225,0.00177755635503322,0.00143911511913888,0.00293200114507338,0.00243895223108253,0.00234559795398315,0.00177942757483524,0.00111480290264119,0.00158727090346751,0.00143909437794666,0.00273443083615598,0.000946827404075986,0.00141255267188061,0.00120055277758705,0.00135461407974346,0.00149932621505372,0.00347057769438888,0.00254512478027435,0.00333993987974456,0.000926489985148059,0.00175302105444171,0.00152311156390034,0.00158098304071077,0.00184259093771528,0.00150532127209725,0.00175325748906283,0.00142336551524023,0.00113335170853075,0.0011831435286209,0.00112527357294344,0.00202067889361045,0.00110599687588991,0.000874150736208628,0.00248760752546771,0.00200473896410157,0.00105664760906249,0.00121011705293451,0.00338613626270459,0.00323266847034943,0.00383175100488151,0.00302682703217745,0.00135174912881923,0.00157344601925656,0.00316648388755249,0.00447843376093827,0.00380552683299899,0.00164899675931867,0.000909756837683135,0.00118177073572284,0.00150505525453812,0.00413159600795348,0.000891181085391255,0.00340435693776371,0.00730186529029193,0.00154997819131858]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","labelHighlightBold":true,"physics":false},"manipulation":{"enabled":false},"layout":{"randomSeed":123},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true}},"groups":["1","3","4","2","5"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":[1,2,3,4,5]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>VisTextNet_e</span><span class='op'>(</span><span class='va'>text_network_before</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-75a7d71d1404043b5c86" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-75a7d71d1404043b5c86">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Central Bulletin","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","News Desk","News Online Today","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"title":["Degree of Node: <br>5","Degree of Node: <br>5","Degree of Node: <br>7","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>8","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>5","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>8","Degree of Node: <br>7","Degree of Node: <br>4","Degree of Node: <br>8","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>5"],"group":[1,3,3,1,4,1,2,4,2,3,1,3,4,3,5,2,5,1,2,5,5,1,5,4,4,2],"size":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"font.weight":[900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["All News Today","Athena Speaks","Central Bulletin","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","News Desk","News Online Today","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"x":[0.367562177594797,-0.348144664917799,-0.551656184451724,0.608275215837129,-0.364720123077769,0.312942242228719,-0.74922513146299,-0.665621707227348,-1,-0.204668877607785,-0.254641610633986,0.0252313210165678,-0.397927211984251,-0.345087097302576,0.718997712299104,-0.745202582747243,0.689730120188893,0.674977541838899,-0.291058724731361,0.388358082471883,1,0.209996180351103,0.822686348369551,-0.640370618157677,-0.226052651002482,-0.932608206060272],"y":[-0.167172706036882,1,0.600690055276472,0.00943528399637472,-1,-0.4421472497995,-0.0616226098505533,-0.596729629851144,0.218110326001227,0.727128621864588,-0.178566773738007,0.618856707528056,-0.500078520981491,0.463518172673109,0.441005959949853,0.302468341904187,0.691573082298033,-0.282187956295467,0.166642658183303,0.772793506707061,0.789652708419243,0.107936994744465,0.980316441304205,-0.907881123181307,-0.737423489510391,0.572327717146989]},"edges":{"from":["All News Today","All News Today","All News Today","All News Today","All News Today","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Daily Pegasus","Daily Pegasus","Daily Pegasus","Everyday News","Everyday News","Everyday News","Everyday News","Homeland Illumination","Homeland Illumination","Homeland Illumination","International News","International News","International News","International News","International News","International Times","International Times","International Times","International Times","Kronos Star","Kronos Star","Kronos Star","Kronos Star","News Desk","News Desk","News Desk","News Desk","News Desk","News Online Today","News Online Today","The Abila Post","The Continent","The Continent","The Continent","The Continent","The Explainer","The Explainer","The General Post","The General Post","The General Post","The General Post","The Guide","The Guide","The Light of Truth","The Light of Truth","The Light of Truth","The Orb","The Truth","The Truth","The Truth","The Tulip","The Tulip","The Tulip","The World","World Journal"],"to":["Daily Pegasus","Homeland Illumination","News Online Today","The Orb","The Wrap","Central Bulletin","News Desk","The Abila Post","The Explainer","Worldwise","International News","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer","Homeland Illumination","The Orb","The Wrap","International Times","The Continent","World Journal","World Source","News Online Today","The Orb","The Wrap","Kronos Star","News Online Today","The Guide","The Truth","Worldwise","News Online Today","The Continent","World Journal","World Source","News Online Today","The Guide","The Truth","Worldwise","The Abila Post","The Explainer","The Truth","The Tulip","The Wrap","The Abila Post","World Source","The Explainer","The Truth","The Wrap","World Journal","World Source","The General Post","The Guide","The Light of Truth","The Tulip","The World","Who What News","The Truth","Worldwise","The Tulip","The World","Who What News","The Wrap","The Tulip","The Wrap","Worldwise","The World","The Wrap","Who What News","Who What News","World Source"],"value":[0.00156162744667993,0.00267032446242905,0.00115483769166408,0.00148798624872667,0.00139937938054064,0.00197286674383265,0.00184509822238823,0.00195494975427119,0.00170566986858221,0.00112080859457602,0.000987044946787035,0.000936701596860749,0.00189407573472961,0.00131782358430141,0.0049229392197231,0.00215577196461759,0.00165442260839225,0.00177755635503322,0.00143911511913888,0.00293200114507338,0.00243895223108253,0.00234559795398315,0.00177942757483524,0.00111480290264119,0.00158727090346751,0.00143909437794666,0.00273443083615598,0.000946827404075986,0.00141255267188061,0.00120055277758705,0.00135461407974346,0.00149932621505372,0.00347057769438888,0.00254512478027435,0.00333993987974456,0.000926489985148059,0.00175302105444171,0.00152311156390034,0.00158098304071077,0.00184259093771528,0.00150532127209725,0.00175325748906283,0.00142336551524023,0.00113335170853075,0.0011831435286209,0.00112527357294344,0.00202067889361045,0.00110599687588991,0.000874150736208628,0.00248760752546771,0.00200473896410157,0.00105664760906249,0.00121011705293451,0.00338613626270459,0.00323266847034943,0.00383175100488151,0.00302682703217745,0.00135174912881923,0.00157344601925656,0.00316648388755249,0.00447843376093827,0.00380552683299899,0.00164899675931867,0.000909756837683135,0.00118177073572284,0.00150505525453812,0.00413159600795348,0.000891181085391255,0.00340435693776371,0.00730186529029193,0.00154997819131858]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","labelHighlightBold":true,"physics":false},"manipulation":{"enabled":false},"layout":{"randomSeed":123},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true}},"groups":["1","3","4","2","5"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":[1,2,3,4,5]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>text_grouped2</span> <span class='op'>&lt;-</span> <span class='va'>clean_news_2014</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span>

<span class='va'>new_2014</span> <span class='op'>&lt;-</span> <span class='fu'>PrepText</span><span class='op'>(</span><span class='va'>text_grouped2</span>, 
                         groupvar <span class='op'>=</span> <span class='st'>"SOURCE"</span>, 
                         textvar <span class='op'>=</span> <span class='st'>"word"</span>, 
                         node_type <span class='op'>=</span> <span class='st'>"groups"</span>, 
                         tokenizer <span class='op'>=</span> <span class='st'>"words"</span>, 
                         pos <span class='op'>=</span> <span class='st'>"nouns"</span>, 
                         remove_stop_words <span class='op'>=</span> <span class='cn'>TRUE</span>, 
                         compound_nouns <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>text_network_2014</span> <span class='op'>&lt;-</span> <span class='fu'>CreateTextnet</span><span class='op'>(</span><span class='va'>new_2014</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>99</span><span class='op'>)</span>
<span class='fu'>VisTextNet_e</span><span class='op'>(</span><span class='va'>text_network_2014</span>, label_degree_cut <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> 
</code></pre>
</div>
<div id="htmlwidget-75c7e5400d7ad6a77594" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-75c7e5400d7ad6a77594">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Central Bulletin","Centrum Sentinel","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","Modern Rubicon","News Desk","News Online Today","Tethys News","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"title":["Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>8","Degree of Node: <br>3","Degree of Node: <br>3","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>8","Degree of Node: <br>3","Degree of Node: <br>6","Degree of Node: <br>9","Degree of Node: <br>4","Degree of Node: <br>7","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>5","Degree of Node: <br>8","Degree of Node: <br>6","Degree of Node: <br>4","Degree of Node: <br>6","Degree of Node: <br>5"],"group":[4,3,3,1,4,5,1,2,5,1,1,3,3,1,1,5,3,3,2,3,4,2,3,3,4,3,5,5,2],"size":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"font.weight":[900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["All News Today","Athena Speaks","Central Bulletin","Centrum Sentinel","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","Modern Rubicon","News Desk","News Online Today","Tethys News","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"x":[0.0090030698337229,0.234259129331518,0.37296991469885,-1,0.193959689167201,0.312912917827893,-0.658075215940575,-0.505001296513942,0.419772383177956,-0.806406519860532,-0.690618297550431,-0.0141625294152617,0.762257933586234,-0.756327385174475,-0.192037603236728,0.610458936250426,0.330854793407002,0.672328645745457,-0.848477675209298,0.738147267135546,-0.264526993444341,-0.340942590507063,0.587095289683014,0.567769850803818,0.395749167234493,1,0.379433229251184,0.0131578514549637,-0.586728158012316],"y":[-0.282735736795384,0.390290060330806,1,0.410905791060646,0.0256257381151228,-0.643429822898142,0.0969452999956686,-0.712592370077541,-0.485432649360427,-0.270526497893207,0.725244912456887,0.35312580232208,-0.0290973213874771,0.41859316497238,0.58478026429872,-1,0.545738705063924,0.85168794791769,-0.561182152212106,0.595727741143318,0.035558872185097,-0.202239199605824,0.3066753959874,0.659257960836214,-0.0569908576922096,0.820714342444053,-0.821938766990792,-0.697754121175437,-0.485323984913442]},"edges":{"from":["All News Today","All News Today","All News Today","All News Today","All News Today","All News Today","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Centrum Sentinel","Centrum Sentinel","Centrum Sentinel","Daily Pegasus","Daily Pegasus","Everyday News","Everyday News","Everyday News","Everyday News","Homeland Illumination","Homeland Illumination","International News","International News","International News","International News","International News","International Times","International Times","International Times","International Times","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Modern Rubicon","Modern Rubicon","News Desk","News Desk","News Desk","News Desk","News Online Today","News Online Today","News Online Today","News Online Today","Tethys News","The Abila Post","The Continent","The Continent","The Continent","The Explainer","The General Post","The General Post","The General Post","The General Post","The Guide","The Guide","The Light of Truth","The Light of Truth","The Light of Truth","The Orb","The Orb","The Truth","The Truth","The Truth","The Tulip","The Tulip","The Tulip","The World","World Journal"],"to":["Daily Pegasus","Homeland Illumination","International News","News Online Today","The Orb","The Wrap","Central Bulletin","News Desk","News Online Today","The Abila Post","The Explainer","The Light of Truth","The Orb","News Desk","News Online Today","The Abila Post","The Explainer","The General Post","The World","Who What News","Homeland Illumination","Modern Rubicon","Tethys News","The Orb","The Wrap","International Times","The Continent","World Journal","World Source","Kronos Star","The Orb","Kronos Star","News Online Today","The Guide","The Truth","Worldwise","News Online Today","The Continent","World Journal","World Source","Tethys News","The Abila Post","The Guide","The Truth","World Source","Worldwise","Tethys News","The Abila Post","The Abila Post","The Explainer","The Tulip","The Wrap","The Explainer","The Wrap","Who What News","World Source","The Abila Post","The Explainer","The Wrap","World Journal","World Source","The General Post","The Light of Truth","The Tulip","The World","Who What News","The Truth","Worldwise","The Tulip","The World","Who What News","The Wrap","Worldwise","The Tulip","The Wrap","Worldwise","The World","The Wrap","Who What News","Who What News","World Source"],"value":[0.0160298826094453,0.00878370063562516,0.00471125382950078,0.0103572856599703,0.0252484554103783,0.0419165869259229,0.00476635168675798,0.0102615273224692,0.0045526081117884,0.005908558439243,0.00918865112100369,0.00641143250109285,0.00473889400945304,0.00543618440793671,0.00622404688098076,0.00661615515918009,0.00576735365574495,0.00510938428691398,0.00474443527522902,0.00602124839147969,0.00981615766199576,0.0159185503666337,0.0141467140032279,0.0142326241625124,0.0150778065462614,0.00363579534874758,0.0080588091530349,0.010019730438558,0.00256289864396314,0.0039387281191265,0.00475176545616622,0.00775515012984981,0.00507037865034193,0.0114558422160912,0.0116055984334645,0.0105698161262255,0.0047775638082416,0.00434774935757406,0.00504850636912421,0.0223631101995694,0.0520024515356954,0.0197492548110723,0.00520803763488444,0.00488525957285427,0.00369890716096897,0.00522394803227689,0.0157798336099964,0.00532883547678585,0.00562457727847846,0.00898551463794424,0.00965259045710242,0.00595573927581586,0.00458022268211378,0.00535515557135,0.00511898022950154,0.00508984204998859,0.0232414737866012,0.00541448026687664,0.00429309457924335,0.0136403426023258,0.00368808249692659,0.00563152742275226,0.00979924613843739,0.00669562350579734,0.0127158724867341,0.0104493261438527,0.0101099896042248,0.0111225827303726,0.00881970051031607,0.0115237243097003,0.00825828134482609,0.0298572176215829,0.00543921036390944,0.00538238561420618,0.0139351337043452,0.00973524058206597,0.00793423400000634,0.00973373620561474,0.00852055244582107,0.0175242903921269,0.00372825837147587]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","labelHighlightBold":true,"physics":false},"manipulation":{"enabled":false},"layout":{"randomSeed":123},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true}},"groups":["4","3","1","5","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":[1,2,3,4,5]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>VisTextNet_e</span><span class='op'>(</span><span class='va'>text_network_2014</span>,label_degree_cut <span class='op'>=</span> <span class='fl'>0</span>,betweenness <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> 
</code></pre>
</div>
<div id="htmlwidget-4fb6f662b222bff97e67" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4fb6f662b222bff97e67">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Central Bulletin","Centrum Sentinel","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","Modern Rubicon","News Desk","News Online Today","Tethys News","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"title":["Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>8","Degree of Node: <br>3","Degree of Node: <br>3","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>8","Degree of Node: <br>3","Degree of Node: <br>6","Degree of Node: <br>9","Degree of Node: <br>4","Degree of Node: <br>7","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>5","Degree of Node: <br>8","Degree of Node: <br>6","Degree of Node: <br>4","Degree of Node: <br>6","Degree of Node: <br>5"],"group":[4,3,3,1,4,5,1,2,5,1,1,3,3,1,1,5,3,3,2,3,4,2,3,3,4,3,5,5,2],"size":[1.05263157894737,53.6842105263158,40,13.6842105263158,0,7.36842105263158,48.421052631579,23.1578947368421,0,87.3684210526316,16.8421052631579,12.6315789473684,114.736842105263,0,41.0526315789474,21.0526315789474,33.6842105263158,5.26315789473684,0,1.05263157894737,36.8421052631579,17.8947368421053,15.7894736842105,0,25.2631578947368,1.05263157894737,0,111.578947368421,0],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"font.weight":[900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["All News Today","Athena Speaks","Central Bulletin","Centrum Sentinel","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","Modern Rubicon","News Desk","News Online Today","Tethys News","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"x":[0.106543327450277,-0.191073771635271,-0.422152995196417,0.842765230722729,0.293646276686703,0.338622375980247,0.594156998708395,0.271018540897433,-0.162514101959347,0.913956724216655,0.990275445414973,-0.180015617286158,-0.62838216388806,1,0.440722599024816,0.385419065066135,-0.073875341128806,-0.572900073405045,0.869181249202505,-0.498547671593163,0.0582268018562371,0.548016481957573,-0.700340809464485,-1,0.332023705164171,-0.593293059832964,0.0490297444494445,0.116993256469481,0.435595005050631],"y":[0.140764710119079,0.430802282390026,0.620430869232415,0.762094055930351,0.386483582254008,-0.932057230310104,0.274678760267806,-0.339030088314487,-0.746626063090534,-0.0485250982076085,0.959181698793962,1,-0.00996296105098182,0.509994271708261,0.843691482481177,-0.648239662240492,0.78903459048358,0.950139784712953,-0.304787630949303,0.273311509247725,0.330632660127449,-0.146671410988078,0.435953820120248,0.45346231301306,0.63293966063017,0.650197958226188,-1,-0.581253268214899,0.0625045325891542]},"edges":{"from":["All News Today","All News Today","All News Today","All News Today","All News Today","All News Today","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Centrum Sentinel","Centrum Sentinel","Centrum Sentinel","Daily Pegasus","Daily Pegasus","Everyday News","Everyday News","Everyday News","Everyday News","Homeland Illumination","Homeland Illumination","International News","International News","International News","International News","International News","International Times","International Times","International Times","International Times","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Modern Rubicon","Modern Rubicon","News Desk","News Desk","News Desk","News Desk","News Online Today","News Online Today","News Online Today","News Online Today","Tethys News","The Abila Post","The Continent","The Continent","The Continent","The Explainer","The General Post","The General Post","The General Post","The General Post","The Guide","The Guide","The Light of Truth","The Light of Truth","The Light of Truth","The Orb","The Orb","The Truth","The Truth","The Truth","The Tulip","The Tulip","The Tulip","The World","World Journal"],"to":["Daily Pegasus","Homeland Illumination","International News","News Online Today","The Orb","The Wrap","Central Bulletin","News Desk","News Online Today","The Abila Post","The Explainer","The Light of Truth","The Orb","News Desk","News Online Today","The Abila Post","The Explainer","The General Post","The World","Who What News","Homeland Illumination","Modern Rubicon","Tethys News","The Orb","The Wrap","International Times","The Continent","World Journal","World Source","Kronos Star","The Orb","Kronos Star","News Online Today","The Guide","The Truth","Worldwise","News Online Today","The Continent","World Journal","World Source","Tethys News","The Abila Post","The Guide","The Truth","World Source","Worldwise","Tethys News","The Abila Post","The Abila Post","The Explainer","The Tulip","The Wrap","The Explainer","The Wrap","Who What News","World Source","The Abila Post","The Explainer","The Wrap","World Journal","World Source","The General Post","The Light of Truth","The Tulip","The World","Who What News","The Truth","Worldwise","The Tulip","The World","Who What News","The Wrap","Worldwise","The Tulip","The Wrap","Worldwise","The World","The Wrap","Who What News","Who What News","World Source"],"value":[0.0160298826094453,0.00878370063562516,0.00471125382950078,0.0103572856599703,0.0252484554103783,0.0419165869259229,0.00476635168675798,0.0102615273224692,0.0045526081117884,0.005908558439243,0.00918865112100369,0.00641143250109285,0.00473889400945304,0.00543618440793671,0.00622404688098076,0.00661615515918009,0.00576735365574495,0.00510938428691398,0.00474443527522902,0.00602124839147969,0.00981615766199576,0.0159185503666337,0.0141467140032279,0.0142326241625124,0.0150778065462614,0.00363579534874758,0.0080588091530349,0.010019730438558,0.00256289864396314,0.0039387281191265,0.00475176545616622,0.00775515012984981,0.00507037865034193,0.0114558422160912,0.0116055984334645,0.0105698161262255,0.0047775638082416,0.00434774935757406,0.00504850636912421,0.0223631101995694,0.0520024515356954,0.0197492548110723,0.00520803763488444,0.00488525957285427,0.00369890716096897,0.00522394803227689,0.0157798336099964,0.00532883547678585,0.00562457727847846,0.00898551463794424,0.00965259045710242,0.00595573927581586,0.00458022268211378,0.00535515557135,0.00511898022950154,0.00508984204998859,0.0232414737866012,0.00541448026687664,0.00429309457924335,0.0136403426023258,0.00368808249692659,0.00563152742275226,0.00979924613843739,0.00669562350579734,0.0127158724867341,0.0104493261438527,0.0101099896042248,0.0111225827303726,0.00881970051031607,0.0115237243097003,0.00825828134482609,0.0298572176215829,0.00543921036390944,0.00538238561420618,0.0139351337043452,0.00973524058206597,0.00793423400000634,0.00973373620561474,0.00852055244582107,0.0175242903921269,0.00372825837147587]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","labelHighlightBold":true,"physics":false},"manipulation":{"enabled":false},"layout":{"randomSeed":123},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true}},"groups":["4","3","1","5","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":[1,2,3,4,5]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<p>N Grams</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wc_comms</span> <span class='op'>&lt;-</span> <span class='fu'>TextComm_e</span><span class='op'>(</span>text_network <span class='op'>=</span> <span class='va'>text_network_before</span><span class='op'>)</span>

<span class='va'>g_before_ngrams</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                             <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>word</span>, token<span class='op'>=</span><span class='st'>"ngrams"</span>, n<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>word</span> <span class='op'>!=</span> <span class='st'>'NA'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>separate</span><span class='op'>(</span><span class='va'>word</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"word1"</span>, <span class='st'>"word2"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word1</span>, <span class='va'>word2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>8</span>, wt<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>SOURCE</span>, .after <span class='op'>=</span> <span class='fu'>last_col</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span><span class='op'>=</span><span class='st'>"word1"</span>,
                             <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"word2"</span>,
                             <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"n"</span>,
                             <span class='st'>"group"</span><span class='op'>=</span><span class='st'>"SOURCE"</span><span class='op'>)</span>
  
  
                      
<span class='va'>add</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>wc_comms</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"group"</span> <span class='op'>=</span> <span class='st'>"SOURCE"</span><span class='op'>)</span><span class='op'>)</span>                
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data_1</span> <span class='op'>&lt;-</span> <span class='va'>add</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data_1</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data_1</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>data_2</span> <span class='op'>&lt;-</span> <span class='va'>add</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data_2</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data_2</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>data_3</span> <span class='op'>&lt;-</span> <span class='va'>add</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data_3</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data_3</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>data_4</span> <span class='op'>&lt;-</span> <span class='va'>add</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data_4</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data_4</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>data_5</span> <span class='op'>&lt;-</span> <span class='va'>add</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data_5</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data_5</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wc_comms_2</span> <span class='op'>&lt;-</span> <span class='fu'>TextComm_e</span><span class='op'>(</span>text_network <span class='op'>=</span> <span class='va'>text_network_2014</span><span class='op'>)</span>

<span class='va'>g_2014_ngrams</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>word</span>, token<span class='op'>=</span><span class='st'>"ngrams"</span>, n<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>word</span> <span class='op'>!=</span> <span class='st'>'NA'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>separate</span><span class='op'>(</span><span class='va'>word</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"word1"</span>, <span class='st'>"word2"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word1</span>, <span class='va'>word2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>2</span>, wt<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>SOURCE</span>, .after <span class='op'>=</span> <span class='fu'>last_col</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span><span class='op'>=</span><span class='st'>"word1"</span>,
                             <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"word2"</span>,
                             <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"n"</span>,
                             <span class='st'>"group"</span><span class='op'>=</span><span class='st'>"SOURCE"</span><span class='op'>)</span>
  
  
                      
<span class='va'>add2</span> <span class='op'>&lt;-</span> <span class='va'>g_2014_ngrams</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>wc_comms_2</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"group"</span> <span class='op'>=</span> <span class='st'>"SOURCE"</span><span class='op'>)</span><span class='op'>)</span>                
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data</span><span class='op'>&lt;-</span> <span class='va'>add2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span>


<span class='va'>data</span><span class='op'>&lt;-</span> <span class='va'>add2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span>


<span class='va'>data</span><span class='op'>&lt;-</span> <span class='va'>add2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 
<span class='co'>#data$nodes$color &lt;- "yellow"</span>

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span>


<span class='va'>data</span><span class='op'>&lt;-</span> <span class='va'>add2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span>


<span class='va'>data</span><span class='op'>&lt;-</span> <span class='va'>add2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span> <span class='op'>==</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>nodes</span>,<span class='va'>data</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>author_links</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>,<span class='va'>AUTHOR</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>Count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>wc_comms</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SOURCE"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>AUTHOR</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span> <span class='op'>=</span> <span class='st'>"AUTHOR"</span>,
                       <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"SOURCE"</span>,
                       <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"Count"</span><span class='op'>)</span>

<span class='va'>g_author</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='va'>author_links</span>, directed<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>

<span class='va'>data_author</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='va'>g_author</span><span class='op'>)</span> 


<span class='va'>data_author</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data_author</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"The Explainer"</span>, 
                                                              <span class='st'>"Athena Speaks"</span>, 
                                                              <span class='st'>"News Desk"</span>,
                                                              <span class='st'>"The Abila Post"</span>,
                                                              <span class='st'>"Kronos Star"</span>,
                                                              <span class='st'>"News Online Today"</span>,
                                                              <span class='st'>"Homeland Illumination"</span>,
                                                              <span class='st'>"All News Today"</span><span class='op'>)</span>, 
                                  <span class='st'>"#e88bc3"</span>, 
                                  <span class='st'>"#b7e697"</span><span class='op'>)</span>

<span class='va'>data_author</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>=</span> <span class='st'>"grey"</span>
<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data_author</span><span class='op'>$</span><span class='va'>nodes</span>, <span class='va'>data_author</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>18</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-581be6d2a069b3d6a3a7" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-581be6d2a069b3d6a3a7">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Homeland Illumination","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer","Petrus Gerhard","Haneson Ngohebo","Maha Salo","Cato Rossini","Cato Rossini, Marcella Trapani","Donato Petri","Eva Thayer","Lelio Masin","Marcella Trapani"],"label":["All News Today","Athena Speaks","Homeland Illumination","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer","Petrus Gerhard","Haneson Ngohebo","Maha Salo","Cato Rossini","Cato Rossini, Marcella Trapani","Donato Petri","Eva Thayer","Lelio Masin","Marcella Trapani"],"color":["#e88bc3","#e88bc3","#e88bc3","#e88bc3","#e88bc3","#e88bc3","#e88bc3","#e88bc3","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697"],"x":[1,-0.928139357423995,0.815555621535042,-0.513206920443257,-0.788321392949078,0.552594799383754,-0.175140567681455,-0.225397114036759,0.745496004648877,-0.533623064081207,0.815573057526283,-1,-0.22468705297076,-0.292408220820433,-0.709370050836879,-0.0201726756820421,-0.828280353323806],"y":[0.404447890511573,0.524035512573251,-0.232912126134409,-0.621683429715966,0.984851954633922,0.516147949660627,1,0.532122882224934,0.168562031197408,0.746854537348963,-0.588884387006559,-0.590655013068789,-1,-0.268711166579594,-0.968417901865746,-0.66577901855716,-0.25243276515507]},"edges":{"from":["All News Today","Athena Speaks","Homeland Illumination","Homeland Illumination","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer"],"to":["Petrus Gerhard","Haneson Ngohebo","Maha Salo","Petrus Gerhard","Cato Rossini","Cato Rossini, Marcella Trapani","Donato Petri","Eva Thayer","Lelio Masin","Marcella Trapani","Haneson Ngohebo","Petrus Gerhard","Haneson Ngohebo","Haneson Ngohebo"],"value":[1,1,46,18,1,35,5,5,3,13,1,3,31,1],"Membership":["1","3","1","1","2","2","2","2","2","2","3","1","3","3"],"color":["grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false,"font":{"size":18}},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>location_links</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>,<span class='va'>LOCATION</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>Count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span> <span class='op'>=</span> <span class='st'>"LOCATION"</span>,
                         <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"SOURCE"</span>,
                         <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"Count"</span><span class='op'>)</span>

<span class='va'>g_loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='va'>location_links</span>, directed<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>

<span class='va'>data_loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='va'>g_loc</span><span class='op'>)</span> 


<span class='va'>data_loc</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data_loc</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NA"</span>, 
                                                        <span class='st'>"ABILA, KRONOS"</span>, 
                                                        <span class='st'>"ELODIS, KRONOS"</span>,
                                                        <span class='st'>"DAVOS,SWITZERLAND"</span>,
                                                        <span class='st'>"CENTRUM, TETHYS"</span>
                                                        <span class='op'>)</span>, 
                                  <span class='st'>"#e88bc3"</span>, 
                                  <span class='st'>"#b7e697"</span><span class='op'>)</span>

<span class='va'>data_loc</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>=</span> <span class='st'>"grey"</span>
<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data_loc</span><span class='op'>$</span><span class='va'>nodes</span>, <span class='va'>data_loc</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='st'>"layout.davidson.harel"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>18</span>, weight<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>, highlightNearest <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span>, degree <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-1ac8d74ab6f35847e17c" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1ac8d74ab6f35847e17c">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Central Bulletin","Centrum Sentinel","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","Modern Rubicon","News Desk","News Online Today","Tethys News","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise","ABILA, KRONOS","ELODIS, KRONOS","NA","CENTRUM, TETHYS","DAVOS, SWITZERLAND"],"label":["All News Today","Athena Speaks","Central Bulletin","Centrum Sentinel","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","Modern Rubicon","News Desk","News Online Today","Tethys News","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise","ABILA, KRONOS","ELODIS, KRONOS","NA","CENTRUM, TETHYS","DAVOS, SWITZERLAND"],"color":["#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#b7e697","#e88bc3","#e88bc3","#e88bc3","#e88bc3","#b7e697"],"x":[-0.268492521700111,-0.0306365652025958,-0.124450011018166,0.983115915410635,-0.119295772103371,0.429294241370194,0.168254476822347,-1,0.628989522930954,-0.489579982502157,0.850171189740084,-0.512291503597757,0.0501384617736773,1,-0.0502631237558406,0.651974873149185,-0.0648922836552334,-0.470990302274332,-0.846393611251939,-0.0199264949771597,0.0835538848442492,-0.23250565915046,-0.722810466394197,-0.0140815893905298,0.175071198471,-0.222010417225192,0.253150431063434,0.816689758378834,-0.932540320369392,-0.604515247838854,-0.0312905580587471,0.562930146779795,-0.183692009404976,-0.361356085553947],"y":[0.215250832054698,0.934282149728545,0.380300669617983,-0.340542505117789,-0.0860550048353074,-0.566996413066941,0.268722167760618,0.0518305982611595,0.242041146478252,-0.78407220933413,0.104626138401224,0.500547336528818,-0.3449432659871,-0.0949981960134625,-0.000412508990710436,-0.679002422718853,0.705244184968233,-0.45528889110545,0.311962098359736,-0.758136945566362,1,-0.147042280301324,-0.706387421499312,-0.465129820793614,-0.0390782914572081,-0.746235091785121,0.0691505989780787,-0.508851285272223,-0.231100759077013,-0.00961862244003397,0.568746911208796,-0.194682081465383,-0.429008571079018,-1]},"edges":{"from":["All News Today","All News Today","All News Today","Athena Speaks","Athena Speaks","Athena Speaks","Central Bulletin","Central Bulletin","Centrum Sentinel","Daily Pegasus","Daily Pegasus","Daily Pegasus","Everyday News","Homeland Illumination","Homeland Illumination","Homeland Illumination","International News","International Times","Kronos Star","Kronos Star","Modern Rubicon","News Desk","News Desk","News Online Today","News Online Today","News Online Today","News Online Today","Tethys News","The Abila Post","The Abila Post","The Abila Post","The Continent","The Explainer","The Explainer","The Explainer","The General Post","The General Post","The General Post","The Guide","The Light of Truth","The Light of Truth","The Light of Truth","The Light of Truth","The Orb","The Orb","The Orb","The Truth","The Truth","The Tulip","The Tulip","The Tulip","The World","The World","The World","The Wrap","The Wrap","The Wrap","Who What News","Who What News","World Journal","World Source","Worldwise"],"to":["ABILA, KRONOS","ELODIS, KRONOS","NA","ABILA, KRONOS","ELODIS, KRONOS","NA","ABILA, KRONOS","ELODIS, KRONOS","NA","ABILA, KRONOS","ELODIS, KRONOS","NA","NA","ABILA, KRONOS","ELODIS, KRONOS","NA","ABILA, KRONOS","NA","ABILA, KRONOS","NA","NA","ABILA, KRONOS","ELODIS, KRONOS","ABILA, KRONOS","CENTRUM, TETHYS","ELODIS, KRONOS","NA","NA","ABILA, KRONOS","ELODIS, KRONOS","NA","NA","ABILA, KRONOS","ELODIS, KRONOS","NA","ABILA, KRONOS","CENTRUM, TETHYS","DAVOS, SWITZERLAND","ABILA, KRONOS","ABILA, KRONOS","CENTRUM, TETHYS","DAVOS, SWITZERLAND","NA","ABILA, KRONOS","ELODIS, KRONOS","NA","ABILA, KRONOS","NA","ABILA, KRONOS","CENTRUM, TETHYS","DAVOS, SWITZERLAND","ABILA, KRONOS","CENTRUM, TETHYS","NA","ABILA, KRONOS","ELODIS, KRONOS","NA","ABILA, KRONOS","CENTRUM, TETHYS","NA","NA","ABILA, KRONOS"],"value":[12,5,1,21,3,1,18,3,36,15,9,2,15,15,7,42,20,14,27,35,30,22,3,74,8,12,17,35,20,3,31,15,20,3,2,9,9,1,28,8,9,1,1,15,9,2,27,1,9,9,1,8,8,1,15,8,3,8,7,15,9,28],"color":["grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false,"font":{"size":18,"weight":3}},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":0,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>reorder_within</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>by</span>, <span class='va'>within</span>, <span class='va'>fun</span> <span class='op'>=</span> <span class='va'>mean</span>, <span class='va'>sep</span> <span class='op'>=</span> <span class='st'>"___"</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>new_x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>within</span>, sep <span class='op'>=</span> <span class='va'>sep</span><span class='op'>)</span>
  <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>new_x</span>, <span class='va'>by</span>, FUN <span class='op'>=</span> <span class='va'>fun</span><span class='op'>)</span>
<span class='op'>}</span>


<span class='va'>scale_x_reordered</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>sep</span> <span class='op'>=</span> <span class='st'>"___"</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>sep</span>, <span class='st'>".+$"</span><span class='op'>)</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='va'>reg</span>, <span class='st'>""</span>, <span class='va'>x</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>scale_y_reordered</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>sep</span> <span class='op'>=</span> <span class='st'>"___"</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>sep</span>, <span class='st'>".+$"</span><span class='op'>)</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='va'>reg</span>, <span class='st'>""</span>, <span class='va'>x</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tf_idf</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                 <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/bind_tf_idf.html'>bind_tf_idf</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>SOURCE</span>, <span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span><span class='fl'>7</span>,wt<span class='op'>=</span><span class='va'>tf_idf</span><span class='op'>)</span> 

<span class='va'>com_tf_idf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>tf_idf</span>, 
                         <span class='va'>wc_comms</span>, 
                         by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SOURCE"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>com_tf_idf</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/reorder_within.html'>reorder_within</a></span><span class='op'>(</span><span class='va'>word</span>, 
                            <span class='va'>tf_idf</span>, 
                            <span class='va'>SOURCE</span><span class='op'>)</span>,
             <span class='va'>tf_idf</span>,
             fill <span class='op'>=</span> <span class='va'>Membership</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'identity'</span>,color<span class='op'>=</span><span class='st'>'black'</span>, size<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/reorder_within.html'>scale_x_reordered</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>SOURCE</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span>, ncol <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1"</span><span class='op'>=</span><span class='st'>'#97c2fc'</span>,
                              <span class='st'>"2"</span><span class='op'>=</span><span class='st'>"#7be141"</span>,
                              <span class='st'>"3"</span><span class='op'>=</span><span class='st'>"#ffff00"</span>,
                              <span class='st'>"4"</span><span class='op'>=</span><span class='st'>'#fb7e81'</span>,
                              <span class='st'>"5"</span><span class='op'>=</span><span class='st'>'#eb7df4'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>''</span>,y<span class='op'>=</span><span class='st'>''</span>, title <span class='op'>=</span> <span class='st'>"TF-IDF"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
        strip.background <span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
        plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>16</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>5</span>,<span class='fl'>0</span><span class='op'>)</span>, hjust<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span>
        <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>, <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>,<span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>SOURCE</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Tethys News"</span>, <span class='st'>"Centrum Sentinel"</span>, <span class='st'>"Modern Rubicon"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>FILE</span>, <span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>avg_word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>wc_comms</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>Membership</span>, <span class='fu'>desc</span><span class='op'>(</span><span class='va'>avg_word</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>SOURCE2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, levels<span class='op'>=</span><span class='va'>SOURCE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>avg_word</span>,<span class='va'>SOURCE2</span>,fill<span class='op'>=</span><span class='va'>Membership</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>'black'</span>, size<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1"</span><span class='op'>=</span><span class='st'>'#97c2fc'</span>,
                              <span class='st'>"2"</span><span class='op'>=</span><span class='st'>"#7be141"</span>,
                              <span class='st'>"3"</span><span class='op'>=</span><span class='st'>"#ffff00"</span>,
                              <span class='st'>"4"</span><span class='op'>=</span><span class='st'>'#fb7e81'</span>,
                              <span class='st'>"5"</span><span class='op'>=</span><span class='st'>'#eb7df4'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Average No. of Words"</span>,
       y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
       title <span class='op'>=</span> <span class='st'>"Average No. of Words in each News Source"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
        panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span><span class='st'>"#d6d6d6"</span><span class='op'>)</span>,
        axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, color<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span>,
        plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>15</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>30</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
        <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>'images/5-1-2.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="mc1_files/figure-html5/words-1.png" width="624" /></p>
</div>
<h3 id="building-the-visuals-for-question-2">4.2 Building the Visuals for Question 2</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g_before_ngrams2</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                             <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>word</span>, token<span class='op'>=</span><span class='st'>"ngrams"</span>, n<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>word</span> <span class='op'>!=</span> <span class='st'>'NA'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>separate</span><span class='op'>(</span><span class='va'>word</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"word1"</span>, <span class='st'>"word2"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word1</span>, <span class='va'>word2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>50</span>, wt<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>SOURCE</span>, .after <span class='op'>=</span> <span class='fu'>last_col</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span><span class='op'>=</span><span class='st'>"word1"</span>,
                             <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"word2"</span>,
                             <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"n"</span>,
                             <span class='st'>"group"</span><span class='op'>=</span><span class='st'>"SOURCE"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams2</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>group</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>pivot_longer</span><span class='op'>(</span>cols<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>,<span class='st'>"to"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/get_sentiments.html'>get_sentiments</a></span><span class='op'>(</span><span class='st'>"bing"</span><span class='op'>)</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"value"</span><span class='op'>=</span><span class='st'>"word"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>replace_na</span><span class='op'>(</span>replace <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sentiment <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"negative"</span>, <span class='st'>"blue"</span>, 
                            <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"none"</span>, <span class='st'>"grey"</span>,
                                   <span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='va'>color</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"id"</span> <span class='op'>=</span> <span class='st'>"value"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>color</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>g_before_ngrams2</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
      <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams2</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>group</span> <span class='op'>==</span><span class='va'>i</span><span class='op'>)</span>
      
      <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>group</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'>pivot_longer</span><span class='op'>(</span>cols<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>,<span class='st'>"to"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/get_sentiments.html'>get_sentiments</a></span><span class='op'>(</span><span class='st'>"bing"</span><span class='op'>)</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"value"</span><span class='op'>=</span><span class='st'>"word"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>replace_na</span><span class='op'>(</span>replace <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sentiment <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"negative"</span>, <span class='st'>"blue"</span>, 
                                <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"none"</span>, <span class='st'>"grey"</span>,
                                       <span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='va'>color</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"id"</span> <span class='op'>=</span> <span class='st'>"value"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>color</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

      <span class='va'>n</span><span class='op'>$</span><span class='va'>label</span> <span class='op'>&lt;-</span> <span class='va'>n</span><span class='op'>$</span><span class='va'>id</span>

      <span class='va'>p</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='va'>n</span>, 
                    edges <span class='op'>=</span> <span class='va'>e</span>, 
                    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"News Source: "</span>,<span class='va'>i</span><span class='op'>)</span>,
                                       style <span class='op'>=</span> <span class='st'>"font-family:Verdana;font-weight:600;color:#000000;font-size:20px;text-align:center;"</span><span class='op'>)</span>
                    <span class='op'>)</span>  <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>34</span>, style<span class='op'>=</span><span class='st'>"font-weight:600"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>physics <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>T</span>, 
                     nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

      <span class='fu'>show</span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
      
      
      
    
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g_before_ngrams2</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                             <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>word</span>, token<span class='op'>=</span><span class='st'>"ngrams"</span>, n<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>word</span> <span class='op'>!=</span> <span class='st'>'NA'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>separate</span><span class='op'>(</span><span class='va'>word</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"word1"</span>, <span class='st'>"word2"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word1</span>, <span class='va'>word2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='co'>#top_n(n=30, wt=n) %&gt;%</span>
                      <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>SOURCE</span>, .after <span class='op'>=</span> <span class='fu'>last_col</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span><span class='op'>=</span><span class='st'>"word1"</span>,
                             <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"word2"</span>,
                             <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"n"</span>,
                             <span class='st'>"group"</span><span class='op'>=</span><span class='st'>"SOURCE"</span><span class='op'>)</span>

<span class='va'>g_before_ngrams_specific</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams2</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>group</span><span class='op'>==</span><span class='st'>"International Times"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
                            <span class='co'>#filter(from %in% c("pok","elodis","police","government")|to %in% c("pok","elodis","police","government"))</span>
                            <span class='co'>#filter(from %in% c("gastech","international", "kronos","sanjorge")| to %in% c("gastech","international","kronos", "sanjorge")) </span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>from</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"people"</span>,<span class='st'>"kronos"</span>,<span class='st'>"pok"</span><span class='op'>)</span><span class='op'>|</span><span class='va'>to</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"people"</span>,<span class='st'>"kronos"</span>, <span class='st'>"pok"</span><span class='op'>)</span><span class='op'>)</span>
          
      <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams_specific</span> <span class='co'>#%&gt;% </span>
            <span class='co'>#filter(group=="Homeland Illumination")</span>
      
      <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>group</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'>pivot_longer</span><span class='op'>(</span>cols<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>,<span class='st'>"to"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/get_sentiments.html'>get_sentiments</a></span><span class='op'>(</span><span class='st'>"bing"</span><span class='op'>)</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"value"</span><span class='op'>=</span><span class='st'>"word"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>replace_na</span><span class='op'>(</span>replace <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sentiment <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>color.background <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"negative"</span>, <span class='st'>"blue"</span>, 
                                <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"none"</span>, <span class='st'>"grey"</span>,
                                       <span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='va'>color.background</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"id"</span> <span class='op'>=</span> <span class='st'>"value"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>color.background</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

      <span class='va'>n</span><span class='op'>$</span><span class='va'>label</span> <span class='op'>&lt;-</span> <span class='va'>n</span><span class='op'>$</span><span class='va'>id</span>
      <span class='va'>n</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>
      <span class='va'>n</span><span class='op'>$</span><span class='va'>color.border</span> <span class='op'>&lt;-</span> <span class='st'>"black"</span>
      <span class='va'>e</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='st'>"gray"</span> 
      

      <span class='va'>p</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, 
                    edges <span class='op'>=</span> <span class='va'>e</span>, 
                    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"News Source: "</span>,<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>e</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span>,
                                       style <span class='op'>=</span> <span class='st'>"font-family:Verdana;font-weight:600;color:#000000;font-size:20px;text-align:center;"</span><span class='op'>)</span>
                    <span class='op'>)</span>  <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span>, color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>highlight <span class='op'>=</span> <span class='st'>"brown"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>34</span>, style<span class='op'>=</span><span class='st'>"font-weight:600"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>physics <span class='op'>=</span> <span class='cn'>F</span>, layout <span class='op'>=</span> <span class='st'>"layout_nicely"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span>, 
                                             algorithm <span class='op'>=</span> <span class='st'>"all"</span>,
                                             degree <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, 
                     nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>
                    <span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">  <span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>e</span>,
                             directed <span class='op'>=</span> <span class='cn'>T</span>,
                             vertices <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span>

  <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/betweenness.html'>betweenness</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>
  <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='va'>size</span><span class='op'>/</span><span class='fl'>700</span>

  <span class='va'>nodes_p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                        size <span class='op'>=</span>  <span class='va'>size</span>,
                        label<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span>
  <span class='va'>e_p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>g</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span>nodes <span class='op'>=</span> <span class='va'>nodes_p</span>, 
             edges <span class='op'>=</span> <span class='va'>e_p</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout_nicely'</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>390</span><span class='op'>)</span>
<span class='va'>p</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>g_before_ngrams2</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams2</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>group</span> <span class='op'>==</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='op'>)</span> 

  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>nodes</span>,
                  <span class='va'>data</span><span class='op'>$</span><span class='va'>edges</span>, main<span class='op'>=</span><span class='va'>i</span>
                  <span class='op'>)</span><span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>30</span>,font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='op'>)</span>

          
  <span class='fu'>show</span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>

<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dtm_corpus</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                     <span class='fu'><a href='http://lubridate.tidyverse.org/reference/year.html'>year</a></span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>wc_comms</span><span class='op'>)</span> 
  
  
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dtm_corpus</span><span class='op'>$</span><span class='va'>Membership</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>dtm_model</span> <span class='op'>&lt;-</span> <span class='va'>dtm_corpus</span> <span class='op'>%&gt;%</span> 
               <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span><span class='op'>==</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
               <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/document_term_casters.html'>cast_dtm</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span>, <span class='va'>count</span><span class='op'>)</span>

  <span class='va'>lda_topics</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/topicmodels/man/lda.html'>LDA</a></span><span class='op'>(</span><span class='va'>dtm_model</span>,
                     k<span class='op'>=</span><span class='fl'>2</span>, 
                     method<span class='op'>=</span><span class='st'>"Gibbs"</span>,
                     control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>seed<span class='op'>=</span><span class='fl'>333</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span>matrix <span class='op'>=</span> <span class='st'>"beta"</span><span class='op'>)</span>
  
  <span class='va'>sources</span> <span class='op'>&lt;-</span> <span class='va'>wc_comms</span> <span class='op'>%&gt;%</span> 
             <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span><span class='op'>==</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
             <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span>
  
    
  <span class='va'>word_probs</span> <span class='op'>&lt;-</span> <span class='va'>lda_topics</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>topic</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='va'>beta</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>term2 <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>term</span>, <span class='va'>beta</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># %&gt;%</span>
                  <span class='co'>#ggplot(aes(term2, beta, fill = as.factor(topic))) +</span>
                  <span class='co'>#geom_col(show.legend=F) +</span>
                  <span class='co'>#labs(x="",</span>
                  <span class='co'>#     y="Sources",</span>
                  <span class='co'>#     title=paste(unlist(sources), collapse = ', '))+</span>
                  <span class='co'>#facet_wrap(~topic, scales = "free_y") +</span>
                  <span class='co'>#coord_flip() +</span>
                  <span class='co'>#theme(</span>
                  <span class='co'>#  panel.background = element_rect(fill="white"),</span>
                  <span class='co'>#  panel.grid.major.x = element_line("#d6d6d6"),</span>
                  <span class='co'>#  axis.text.x = element_text(color='black'),</span>
                  <span class='co'>#  plot.title = element_text(size=12, margin=margin(0,0,30,0)),</span>
                  <span class='co'>#  strip.background = element_rect(fill="white",colour = "black")</span>
      
                  <span class='co'>#)</span>
  
  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://lepennec.github.io/ggwordcloud/reference/ggwordcloud.html'>ggwordcloud</a></span><span class='op'>(</span><span class='va'>word_probs</span><span class='op'>$</span><span class='va'>term</span>, 
                   freq <span class='op'>=</span> <span class='va'>word_probs</span><span class='op'>$</span><span class='va'>beta</span>, 
                   colors <span class='op'>=</span> <span class='va'>word_probs</span><span class='op'>$</span><span class='va'>topic</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Wordcloud for Cluster: "</span>, <span class='va'>i</span><span class='op'>)</span>,
            subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>sources</span><span class='op'>)</span>, collapse <span class='op'>=</span> <span class='st'>', '</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size<span class='op'>=</span><span class='fl'>14</span><span class='op'>)</span>,
             plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size<span class='op'>=</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'>show</span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='co'>#ggsave(paste('images/5-1-6-',i,".png",sep = ''))</span>

<span class='op'>}</span>
</code></pre>
</div>
<p><img src="mc1_files/figure-html5/unnamed-chunk-40-1.png" width="624" /><img src="mc1_files/figure-html5/unnamed-chunk-40-2.png" width="624" /><img src="mc1_files/figure-html5/unnamed-chunk-40-3.png" width="624" /><img src="mc1_files/figure-html5/unnamed-chunk-40-4.png" width="624" /><img src="mc1_files/figure-html5/unnamed-chunk-40-5.png" width="624" /></p>
</div>
<h3 id="building-the-visuals-for-question-3">4.3 Building the Visuals for Question 3</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>links</span> <span class='op'>&lt;-</span> <span class='va'>df.emails</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_split</span><span class='op'>(</span><span class='va'>To</span>,pattern<span class='op'>=</span><span class='st'>','</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'>unnest_longer</span><span class='op'>(</span><span class='va'>To</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>To</span><span class='op'>)</span>,
                 From <span class='op'>=</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>From</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>From</span><span class='op'>==</span><span class='va'>To</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>From</span>, <span class='va'>To</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>weight <span class='op'>=</span> <span class='va'>count</span><span class='op'>)</span>

<span class='va'>nodes_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>links</span><span class='op'>$</span><span class='va'>From</span>, <span class='va'>links</span><span class='op'>$</span><span class='va'>To</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>df.emp</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span><span class='op'>=</span><span class='st'>"FullName"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>id</span>, 
                     <span class='va'>CurrentEmploymentTitle</span>, 
                     <span class='va'>CurrentEmploymentType</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='va'>CurrentEmploymentTitle</span>, 
                   department <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>replace_na</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>department <span class='op'>=</span> <span class='st'>"Executive"</span>, 
                            title <span class='op'>=</span> <span class='st'>"CEO"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Department Network:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>email_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>links</span>, 
                                       vertices <span class='op'>=</span> <span class='va'>nodes_df</span>, 
                                       directed <span class='op'>=</span> <span class='cn'>T</span>
                                       <span class='op'>)</span>

<span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                    title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                    group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>department</span><span class='op'>)</span>


<span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>email_network</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>
<span class='va'>edges</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='va'>links</span><span class='op'>$</span><span class='va'>weight</span>

<span class='va'>nodes</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>

  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes</span>, <span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span>, degree <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, 
                 nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>,
                 selectedBy <span class='op'>=</span> <span class='st'>"group"</span>
                 <span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span>,width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLayout.html'>visLayout</a></span><span class='op'>(</span>randomSeed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='co'>#visPhysics(stabilization = 5,</span>
      <span class='co'>#           barnesHut = list(springLength =230), </span>
      <span class='co'>#           forceAtlas2Based = list(gravitaionalConstant = -100,</span>
      <span class='co'>#                                   centralGravity = 0.5))</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span>

<span class='va'>p</span>
</code></pre>
</div>
<div id="htmlwidget-d00dd67d7949b2a0ae29" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d00dd67d7949b2a0ae29">{"x":{"nodes":{"id":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"title":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"group":["Executive","Facilities","Engineering","Facilities","Administration","Engineering","Facilities","Facilities","Engineering","Engineering","Administration","Facilities","Facilities","Administration","Facilities","Facilities","Security","Engineering","Facilities","Engineering","Security","Engineering","Facilities","Security","Security","Security","Executive","Facilities","Information Technology","Engineering","Security","Security","Engineering","Engineering","Engineering","Administration","Information Technology","Security","Information Technology","Engineering","Administration","Security","Information Technology","Executive","Administration","Administration","Executive","Security","Information Technology","Facilities","Security","Facilities","Engineering","Executive"],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"x":[-1,0.607168659305161,1,0.530018240178163,0.046132143215925,0.29316508971799,0.655526549931672,0.596468580556142,0.843937957345956,0.626242473812741,0.00509254687090666,0.586069696540159,0.210722890735956,-0.116951218930925,0.5124737760059,0.642971638664806,-0.808984249376488,0.75547893742287,0.707216132161128,0.359910082397298,-0.766428083966449,0.568421676755117,0.0665415321610003,-0.425623010269675,-0.818507054729916,-0.916714571130851,-0.262939055229751,0.31076641688138,0.563727337798318,0.711485258595913,-0.665824792828815,-0.652070445868694,0.626162750259777,0.563890913770659,0.63923088569376,-0.0849910453691681,0.0314029891110559,-0.433628396497349,0.664652619797617,0.701350773826982,0.0197255985740596,-0.331509507792674,0.0495020268331992,-0.26941478752899,-0.13744094620503,-0.250758747512016,-0.548010929230835,-0.559334466808362,0.426218174219522,0.490179961803735,-0.773095110289764,0.619027583347468,0.0446886110654288,-0.892154069986047],"y":[0.165746457079203,1,-0.436456578190948,0.766257055441709,0.425086354127586,-0.395721873323206,0.525928184050031,0.662632800612965,-0.558333875327453,-1,0.337984972930386,0.869311518169754,0.733813819433562,0.274740144576765,0.655088641475778,0.851655344808513,0.626456488662165,-0.454024410459196,0.990145349855043,-0.375298886481393,0.799958183324823,-0.697126071190695,0.730110968807174,0.485137872830024,0.331638654049708,0.769533559527763,0.00598870251495587,0.724661833076651,-6.25454564316952e-05,-0.727622268137659,0.672460517307784,0.589818816685851,-0.588834773159001,-0.522067249034361,-0.855621794108936,0.399516833855227,0.59083480627717,0.608769192202986,0.214023868423512,-0.565617640372404,0.496078838797216,0.327864130519898,0.129220110030126,-0.11038198216028,0.57952146042344,0.431492225859125,-0.0563940559272095,0.483842673138941,0.101605393233859,0.801565013009355,0.523344966921234,0.575005718370478,-0.229746793647576,0.261463599591769]},"edges":{"from":["Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Isak Baza","Isak Baza","Isak Baza","Isak Baza","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Sven Flecha","Sven Flecha","Sven Flecha","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais"],"to":["Felix Resumir","Ingrid Barranco","Orhan Strum","Ruscella Mies Haber","Sten Sanjorge Jr","Willem Vasco-Pais","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Axel Calzas","Birgitta Frente","Brand Tempestad","Cecilia Morluniau","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Ruscella Mies Haber","Vira Frente","Adan Morlun","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Rachel Pantanal","Valeria Morlun","Varro Awelon","Carla Forluniau","Cornelia Lais","Gustav Cazar","Henk Mies","Lars Azada","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Valeria Morlun","Adra Nubarron","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Nils Calixto","Varja Lagos","Vira Frente","Adan Morlun","Albina Hafon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Elsa Orilla","Emile Arpa","Felix Resumir","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isak Baza","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Anda Ribera","Cornelia Lais","Felix Balas","Irene Nant","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Ingrid Barranco","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Isia Vann","Linnea Bergen","Rachel Pantanal","Valeria Morlun","Varro Awelon","Anda Ribera","Carla Forluniau","Hideki Cocinaro","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dylan Scozzese","Emile Arpa","Felix Resumir","Henk Mies","Hideki Cocinaro","Irene Nant","Lucas Alcazar","Mat Bramar","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Elsa Orilla","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Edvard Vann","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Henk Mies","Irene Nant","Lucas Alcazar","Marin Onda","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Carla Forluniau","Elsa Orilla","Gustav Cazar","Hennie Osvaldo","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Varja Lagos","Vira Frente","Ada Campo-Corrente","Benito Hawelon","Dante Coginian","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Orhan Strum","Vira Frente","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Edvard Vann","Emile Arpa","Inga Ferro","Irene Nant","Sten Sanjorge Jr","Valeria Morlun","Varro Awelon","Edvard Vann","Felix Balas","Felix Resumir","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Cornelia Lais","Dante Coginian","Edvard Vann","Felix Resumir","Hennie Osvaldo","Inga Ferro","Isande Borrasca","Isia Vann","Kanon Herrero","Minke Mies","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Willem Vasco-Pais","Ada Campo-Corrente","Cecilia Morluniau","Kare Orilla","Loreto Bodrogi","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Orhan Strum","Valeria Morlun","Varro Awelon","Birgitta Frente","Lucas Alcazar","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Hideki Cocinaro","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Claudio Hawelon","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Irene Nant","Isia Vann","Loreto Bodrogi","Minke Mies","Nils Calixto","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Inga Ferro","Ingrid Barranco","Isande Borrasca","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Marin Onda","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Vira Frente","Axel Calzas","Claudio Hawelon","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Lucas Alcazar","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Isia Vann","Kanon Herrero","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Dante Coginian","Emile Arpa","Isak Baza","Linnea Bergen","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Emile Arpa","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Dante Coginian","Linda Lagos","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adra Nubarron","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Nils Calixto","Ruscella Mies Haber","Vira Frente","Axel Calzas","Isak Baza","Kanon Herrero","Lucas Alcazar","Minke Mies","Sven Flecha","Ada Campo-Corrente","Gustav Cazar","Ingrid Barranco","Irene Nant","Sten Sanjorge Jr","Stenig Fusil","Willem Vasco-Pais","Albina Hafon","Anda Ribera","Carla Forluniau","Claudio Hawelon","Cornelia Lais","Hennie Osvaldo","Isia Vann","Linda Lagos","Mat Bramar","Ruscella Mies Haber","Ada Campo-Corrente","Adra Nubarron","Anda Ribera","Carla Forluniau","Cornelia Lais","Hennie Osvaldo","Inga Ferro","Isia Vann","Linda Lagos","Loreto Bodrogi","Mat Bramar","Minke Mies","Rachel Pantanal","Ada Campo-Corrente","Henk Mies","Ingrid Barranco","Orhan Strum","Willem Vasco-Pais","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Orhan Strum","Varja Lagos","Vira Frente","Isak Baza","Lucas Alcazar","Nils Calixto","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Stenig Fusil","Varro Awelon","Axel Calzas","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Mat Bramar","Valeria Morlun","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Marin Onda","Minke Mies","Stenig Fusil","Ada Campo-Corrente","Inga Ferro","Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Varja Lagos"],"value":[2,8,9,1,16,9,11,8,2,8,6,9,14,6,11,9,11,6,2,3,5,1,5,4,2,4,4,4,3,4,2,2,10,14,5,12,7,7,17,6,11,11,2,9,4,13,16,2,2,2,13,13,13,13,2,3,4,3,8,6,5,3,6,10,4,3,3,2,7,7,13,2,7,10,9,5,3,8,3,11,5,9,6,24,24,24,23,24,24,24,25,25,24,25,23,2,3,4,5,2,3,3,3,3,5,1,3,2,10,8,7,7,6,5,9,9,9,10,8,7,19,19,2,1,19,19,19,19,3,8,10,4,5,8,5,7,2,9,2,8,5,3,10,12,7,3,11,5,9,6,10,13,2,1,1,8,7,23,20,2,20,20,20,20,8,5,6,2,4,7,6,7,1,6,2,5,2,1,5,5,14,16,7,2,11,11,8,10,9,13,13,6,3,4,1,5,3,3,3,3,3,4,1,2,9,9,2,6,10,2,6,9,5,10,10,8,10,7,6,4,3,1,2,6,3,4,3,3,2,2,5,4,7,5,6,7,2,4,3,1,6,6,7,5,6,1,4,2,2,2,3,3,2,2,1,2,2,2,2,2,3,1,7,3,4,8,3,5,4,9,6,3,3,4,19,20,2,23,5,16,16,14,18,1,14,3,16,2,17,11,1,1,3,3,3,6,3,4,4,2,2,3,2,2,3,2,1,3,3,1,4,1,2,3,3,1,1,3,6,1,5,2,6,9,2,1,2,2,14,1,2,2,6,6,3,8,7,5,3,9,9,6,8,4,5,2,2,4,2,31,24,31,2,9,5,7,7,5,4,1,10,6,4,8,5,4,3,4,4,2,1,3,2,8,2,3,4,4,6,1,5,1,1,2,5,3,1,3,7,5,1,2,10,7,4,3,1,1,7,3,7,9,3,8,2,12,5,7,7,5,1,4,5,10,5,6,7,8,5,7,5,6,4,5,10,7,6,6,18,18,18,18,18,18,1,1,2,3,3,3,3,1,3,2,5,1,1,5,2,4,3,4,2,4,1,2,3,1,2,40,1,22,30,3,2,2,3,2,2,3,3,2,3,2,2,5,18,18,18,1,18,18,18,3,1,1,4,1,1,2,1,3,2,23,2,31,2,31,6,3,3,2,4,1,11,1,14,14,1,14,2,5,14,14,16,1,2,14,14,14,2,2,2,14,2,14,2,14,20,2,8,11,14,4,8,9,7,4,5,6,6,6,1,5,2,24,20,29,3,3,1,2,2,7,4,5,3,4,2,1,5,1,2,4,6,7,5,5,6,6,5,6,4,7,5,1,2,5,6,5,3,2,5,5,3,5,3,10,2,5,7,4,4,4,5,4,4,1,7,3,2,11,2,4,14,9,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"width":0.5,"arrows":"middle","smooth":false},"layout":{"randomSeed":123},"physics":{"stabilization":false}},"groups":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Administration","Engineering","Executive","Facilities","Information Technology","Security"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
<p>Centrality Based Networks</p>
Sizing by Betweeness Centrality
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>email_network3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>links</span>, 
                                        vertices <span class='op'>=</span> <span class='va'>nodes_df</span>, 
                                        directed <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>

<span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/betweenness.html'>betweenness</a></span><span class='op'>(</span><span class='va'>email_network3</span><span class='op'>)</span>
<span class='va'>email_network3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='va'>email_network3</span><span class='op'>)</span>


<span class='va'>nodes2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network3</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                     title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network3</span><span class='op'>)</span><span class='op'>$</span><span class='va'>title</span>, 
                     group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network3</span><span class='op'>)</span><span class='op'>$</span><span class='va'>department</span><span class='op'>)</span>,
                     size <span class='op'>=</span> <span class='va'>size</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span>

<span class='va'>edges2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>email_network3</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>

<span class='va'>nodes2</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>

<span class='va'>q</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes2</span>, <span class='va'>edges2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span>, degree<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>, 
               nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>,
               selectedBy <span class='op'>=</span> <span class='st'>"group"</span>
               <span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLayout.html'>visLayout</a></span><span class='op'>(</span>randomSeed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span>
<span class='va'>q</span>
</code></pre>
</div>
<div id="htmlwidget-4808fd13d7f36620e0c8" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4808fd13d7f36620e0c8">{"x":{"nodes":{"id":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"title":["SVP/CIO","Truck Driver","Geologist","Truck Driver","Assistant to CFO","Drill Technician","Truck Driver","Facilities Group Manager","Geologist","Drill Technician","Assistant to IT Group Manager","Truck Driver","Truck Driver","Assistant to Security Group Manager","Lead Janitor","Truck Driver","Perimeter Control","Drill Technician","Janitor","Engineer","Security Group Manager","Hydraulic Technician","Truck Driver","Perimeter Control","Site Control","Site Control","SVP/CFO","Truck Driver","IT Technician","Drill Technician","Perimeter Control","Badging Office","Drill Technician","Engineer","Engineering Group Manager","Assistant to COO","IT Group Manager","Site Control","IT Helpdesk","Drill Site Manager","Assistant to CEO","Perimeter Control","IT Technician","SVP/COO","Assistant to CIO","Assistant to Engineering Group Manager","CEO","Building Control","IT Technician","Truck Driver","Badging Office","Janitor","Hydraulic Technician","Environmental Safety Advisor"],"group":["Executive","Facilities","Engineering","Facilities","Administration","Engineering","Facilities","Facilities","Engineering","Engineering","Administration","Facilities","Facilities","Administration","Facilities","Facilities","Security","Engineering","Facilities","Engineering","Security","Engineering","Facilities","Security","Security","Security","Executive","Facilities","Information Technology","Engineering","Security","Security","Engineering","Engineering","Engineering","Administration","Information Technology","Security","Information Technology","Engineering","Administration","Security","Information Technology","Executive","Administration","Administration","Executive","Security","Information Technology","Facilities","Security","Facilities","Engineering","Executive"],"size":[0,0,36.6679438338313,1.20708874458874,9.60385339437064,30.2212041634836,7.96155363155363,31.7924464424464,29.2273719336219,0,7.21986087986088,13.6907696932697,10.0525997460908,0,45.6271865171865,0,50.9240751891166,1.0719696969697,22.7408354863527,21.1097838393491,53.5196805640603,11.0070170570171,19.8079777565984,30.6933766919502,36.2400472124257,48.5014650888238,3.82882706374086,13.1268833823182,0,7.98233525733526,17.1749523858731,32.7586286452015,26.5103805708978,0.73006253006253,0,0,24.0623266983561,18.8098004840958,27.1136844636845,19.6372171809672,0,31.7830051524028,0.333333333333333,0.268686868686869,13.4039769021355,11.0146500439979,0,53.6436507735095,0,30.3560900264659,20.9318373755874,3.24968013468013,19.8455507455507,0.194444444444444],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"x":[0.437881650102451,1,-0.436750433760661,0.613863250312451,-0.285069946670653,-0.66212187351415,0.38242021291691,0.681434231235164,-0.693783369376695,-0.698260523304028,0.011825997761884,0.49770148121836,0.271811770187478,-0.0721171810248953,0.166662235735598,0.718688510477372,-0.157755167536445,-0.55520860400908,0.604268813973413,-0.586442656078568,0.00433911920014651,-0.563822939043709,0.776221707454714,-0.239254834896089,-0.172428884240609,-0.454361141083621,0.596972853199131,0.456425554005158,-0.400492447748699,-0.485122919045816,-0.0125488433620465,-0.0343759051236122,-0.84008393064589,-1,-0.656572479885926,-0.215926245720196,-0.22711933221732,-0.263570584134097,0.271323577861281,-0.608435440184274,0.117356173922258,-0.29702422654959,-0.426982438415868,0.477774838709547,0.0485565676021402,-0.264784459969166,0.68339218656602,0.0968722983145098,-0.0962809220765874,0.631336527944599,-0.453855273051908,0.748548957108885,-0.323994299174411,0.258748069681866],"y":[-0.340117914452122,0.957265543898358,0.379638701201473,0.617935512756614,0.667402485643936,-0.11612203770275,0.561671280538362,0.60678685933559,-0.504054920213018,0.323338783355644,1,0.319695374096874,0.473865040174326,0.674769299175141,0.465402719708187,0.452349084467366,-0.403559559296336,0.228666647552814,0.295951914437385,-0.0578759982040701,-0.220157089484076,0.383001741773972,-0.150733323557595,0.212588357726503,-0.144423724899272,-0.561899488356912,-0.236835277556472,0.511468842634009,-1,-0.0459456919773014,0.0184965260572494,-0.311727600438872,0.647560568790933,0.716479844844426,0.409193319148538,0.534573886737937,-0.0437748095959393,-0.173289117907598,-0.25850665398588,0.245869115093293,0.761357176223641,-0.378173659778633,-0.814374756431112,-0.515971796062141,0.54758038091077,0.311057650243973,-0.535130215696611,-0.301200050699977,-0.84974600296033,0.18341588812308,-0.477622328094947,0.771143983720146,0.573791458276599,-0.639906210834099]},"edges":{"from":["Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Isak Baza","Isak Baza","Isak Baza","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Lars Azada","Lars Azada","Lars Azada","Lidelse Dedos","Lidelse Dedos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Lucas Alcazar","Lucas Alcazar","Marin Onda","Mat Bramar","Mat Bramar","Mat Bramar","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Nils Calixto","Orhan Strum","Orhan Strum","Orhan Strum","Rachel Pantanal","Sten Sanjorge Jr","Stenig Fusil","Stenig Fusil","Stenig Fusil","Valeria Morlun","Varja Lagos"],"to":["Felix Resumir","Ingrid Barranco","Orhan Strum","Ruscella Mies Haber","Sten Sanjorge Jr","Willem Vasco-Pais","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Axel Calzas","Birgitta Frente","Brand Tempestad","Cecilia Morluniau","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Minke Mies","Ruscella Mies Haber","Vira Frente","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Rachel Pantanal","Valeria Morlun","Varro Awelon","Carla Forluniau","Cornelia Lais","Gustav Cazar","Henk Mies","Lars Azada","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Valeria Morlun","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Linnea Bergen","Marin Onda","Nils Calixto","Varja Lagos","Vira Frente","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Elsa Orilla","Emile Arpa","Felix Resumir","Henk Mies","Irene Nant","Kare Orilla","Valeria Morlun","Varro Awelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isak Baza","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Cornelia Lais","Felix Balas","Irene Nant","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Ingrid Barranco","Irene Nant","Valeria Morlun","Varro Awelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Isia Vann","Linnea Bergen","Rachel Pantanal","Valeria Morlun","Varro Awelon","Hideki Cocinaro","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Dylan Scozzese","Emile Arpa","Felix Resumir","Henk Mies","Hideki Cocinaro","Irene Nant","Lucas Alcazar","Mat Bramar","Valeria Morlun","Varro Awelon","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Elsa Orilla","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Henk Mies","Irene Nant","Lucas Alcazar","Marin Onda","Valeria Morlun","Varro Awelon","Gustav Cazar","Hennie Osvaldo","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Varja Lagos","Vira Frente","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Orhan Strum","Vira Frente","Inga Ferro","Irene Nant","Sten Sanjorge Jr","Valeria Morlun","Varro Awelon","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Linnea Bergen","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Inga Ferro","Isande Borrasca","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Isia Vann","Kanon Herrero","Kare Orilla","Linnea Bergen","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Willem Vasco-Pais","Kare Orilla","Loreto Bodrogi","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Kanon Herrero","Orhan Strum","Valeria Morlun","Varro Awelon","Lucas Alcazar","Nils Calixto","Sven Flecha","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Kanon Herrero","Linnea Bergen","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Loreto Bodrogi","Minke Mies","Nils Calixto","Stenig Fusil","Varja Lagos","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Lidelse Dedos","Marin Onda","Vira Frente","Marin Onda","Vira Frente","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Vira Frente","Loreto Bodrogi","Lucas Alcazar","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Nils Calixto","Sven Flecha","Vira Frente","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Nils Calixto","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Vira Frente","Sven Flecha","Sten Sanjorge Jr","Stenig Fusil","Willem Vasco-Pais","Ruscella Mies Haber","Willem Vasco-Pais","Valeria Morlun","Varja Lagos","Vira Frente","Varro Awelon","Willem Vasco-Pais"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"layout":{"randomSeed":123},"edges":{"smooth":false},"physics":{"stabilization":false}},"groups":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Administration","Engineering","Executive","Facilities","Information Technology","Security"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":0,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
Sizing by Eigenvalue Centrality
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>email_network4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>links</span>, 
                                        vertices <span class='op'>=</span> <span class='va'>nodes_df</span>, 
                                        directed <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>

<span class='va'>size</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/eigen_centrality.html'>eigen_centrality</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>vector</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>50</span>

<span class='va'>nodes3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                     title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>title</span>, 
                     group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>department</span><span class='op'>)</span>,
                     size <span class='op'>=</span> <span class='va'>size</span><span class='op'>)</span>

<span class='va'>edges3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>email_network4</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes3</span>, <span class='va'>edges3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span>, 
             nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>,
             selectedBy <span class='op'>=</span> <span class='st'>"group"</span>
             <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLayout.html'>visLayout</a></span><span class='op'>(</span>randomSeed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLegend.html'>visLegend</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-542633577af928a3e4cc" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-542633577af928a3e4cc">{"x":{"nodes":{"id":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"title":["SVP/CIO","Truck Driver","Geologist","Truck Driver","Assistant to CFO","Drill Technician","Truck Driver","Facilities Group Manager","Geologist","Drill Technician","Assistant to IT Group Manager","Truck Driver","Truck Driver","Assistant to Security Group Manager","Lead Janitor","Truck Driver","Perimeter Control","Drill Technician","Janitor","Engineer","Security Group Manager","Hydraulic Technician","Truck Driver","Perimeter Control","Site Control","Site Control","SVP/CFO","Truck Driver","IT Technician","Drill Technician","Perimeter Control","Badging Office","Drill Technician","Engineer","Engineering Group Manager","Assistant to COO","IT Group Manager","Site Control","IT Helpdesk","Drill Site Manager","Assistant to CEO","Perimeter Control","IT Technician","SVP/COO","Assistant to CIO","Assistant to Engineering Group Manager","CEO","Building Control","IT Technician","Truck Driver","Badging Office","Janitor","Hydraulic Technician","Environmental Safety Advisor"],"group":["Executive","Facilities","Engineering","Facilities","Administration","Engineering","Facilities","Facilities","Engineering","Engineering","Administration","Facilities","Facilities","Administration","Facilities","Facilities","Security","Engineering","Facilities","Engineering","Security","Engineering","Facilities","Security","Security","Security","Executive","Facilities","Information Technology","Engineering","Security","Security","Engineering","Engineering","Engineering","Administration","Information Technology","Security","Information Technology","Engineering","Administration","Security","Information Technology","Executive","Administration","Administration","Executive","Security","Information Technology","Facilities","Security","Facilities","Engineering","Executive"],"size":[0.38449575667663,37.8336758212759,0.477352646337115,41.7852462973701,6.74876595241476,0.312857191265348,34.9344982013292,50,0.200158534187925,0.338738228475957,6.86664507668124,32.7805636238712,36.8274958971966,6.56201381680128,28.7744053087322,40.4128725948424,0.649680548882317,1.0934839044534,24.4683893115276,0.364988281926321,1.30900345955662,0.339983313320005,48.2881180853222,0.521783429773694,0.94796333048545,1.61513915575493,0.603824249776211,32.383442355282,0.805209017196291,0.270325654500609,1.62217391938676,0.352659661116004,0.462892860958791,0.418266582686455,0.284832447698852,6.13970363391054,0.763608576048038,0.325771983122083,1.44085586884824,0.648615166314628,6.92990365988279,0.306575220402586,0.735203632923306,0.753695989833899,6.54778208021948,5.73636944817884,1.05595756966522,0.414974174508559,0.726533733244328,27.3377575503073,0.281557904015274,24.3392728627425,0.318109458406652,0.279798097457496],"label":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"x":[0.799850621094598,-0.467020974936673,0.317956443450989,-0.584990057509871,-0.39065331316794,-0.135146915246516,-0.435841886968718,-0.763664083020679,-0.011249397002327,0.147627372264939,-0.59185584655837,-0.41824567715347,-0.302280630369878,-0.177362455442711,-0.554460683096804,-0.560303703035243,0.44707917831828,0.0682623396798414,-0.730805051276673,0.08756762891,-0.05868436213413,0.495823549795959,-0.118307070906184,0.201341739070843,0.110657529441824,0.602703294852777,0.597568408969166,-0.715986314680792,-0.780353618614637,0.00554509777207857,0.30877897834931,0.136985757373098,-0.0253164359809248,-0.287956677356822,0.0842059693440105,-0.24477946988731,-0.104643563790019,0.373969242837865,-0.959343584875119,-0.228357862793077,-0.306557730962705,0.203798272596096,-0.753935465641788,0.948435589664108,-0.252995458906644,0.10838517344416,0.816962977854788,0.459290032750174,-1,-0.548094975020013,0.377967503055978,-0.595741630526599,0.693408619426219,1],"y":[0.248414602417079,0.78605037517042,-0.655182782081787,0.642215040617541,0.0473240001017547,-1,0.59983855242223,0.748857538002518,-0.765193766058178,-0.760583266525268,-0.0142723562707272,0.698625176905994,0.613716445161094,0.0404531211393313,0.386496081307116,0.745116235959287,0.368736948499734,-0.685566410239554,1,-0.466504513857668,0.583067801182219,-0.65929025025382,0.698552235847457,0.154670607901763,0.329578040006256,0.195181236869791,0.434128254862506,0.881994061449316,-0.236436879664129,-0.30014484945706,0.288166988176547,0.404696411808694,-0.552506303633779,-0.926708038552976,-0.724684579036145,-0.0191385273109609,0.178795781155668,0.285687798164837,0.228180448018288,-0.926660082829408,0.121948212604044,-0.0902435037499412,-0.0700479985411788,0.472095889282727,0.247464328522901,-0.0710519077890018,0.392457803874692,0.313935784666711,-0.0598495615854505,0.67369102157529,0.129037385818656,0.408745169480917,-0.683978078390985,0.213882760093685]},"edges":{"from":["Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Isak Baza","Isak Baza","Isak Baza","Isak Baza","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Sven Flecha","Sven Flecha","Sven Flecha","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais"],"to":["Felix Resumir","Ingrid Barranco","Orhan Strum","Ruscella Mies Haber","Sten Sanjorge Jr","Willem Vasco-Pais","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Axel Calzas","Birgitta Frente","Brand Tempestad","Cecilia Morluniau","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Ruscella Mies Haber","Vira Frente","Adan Morlun","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Rachel Pantanal","Valeria Morlun","Varro Awelon","Carla Forluniau","Cornelia Lais","Gustav Cazar","Henk Mies","Lars Azada","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Valeria Morlun","Adra Nubarron","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Nils Calixto","Varja Lagos","Vira Frente","Adan Morlun","Albina Hafon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Elsa Orilla","Emile Arpa","Felix Resumir","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isak Baza","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Anda Ribera","Cornelia Lais","Felix Balas","Irene Nant","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Ingrid Barranco","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Isia Vann","Linnea Bergen","Rachel Pantanal","Valeria Morlun","Varro Awelon","Anda Ribera","Carla Forluniau","Hideki Cocinaro","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dylan Scozzese","Emile Arpa","Felix Resumir","Henk Mies","Hideki Cocinaro","Irene Nant","Lucas Alcazar","Mat Bramar","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Elsa Orilla","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Edvard Vann","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Henk Mies","Irene Nant","Lucas Alcazar","Marin Onda","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Carla Forluniau","Elsa Orilla","Gustav Cazar","Hennie Osvaldo","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Varja Lagos","Vira Frente","Ada Campo-Corrente","Benito Hawelon","Dante Coginian","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Orhan Strum","Vira Frente","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Edvard Vann","Emile Arpa","Inga Ferro","Irene Nant","Sten Sanjorge Jr","Valeria Morlun","Varro Awelon","Edvard Vann","Felix Balas","Felix Resumir","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Cornelia Lais","Dante Coginian","Edvard Vann","Felix Resumir","Hennie Osvaldo","Inga Ferro","Isande Borrasca","Isia Vann","Kanon Herrero","Minke Mies","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Willem Vasco-Pais","Ada Campo-Corrente","Cecilia Morluniau","Kare Orilla","Loreto Bodrogi","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Orhan Strum","Valeria Morlun","Varro Awelon","Birgitta Frente","Lucas Alcazar","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Hideki Cocinaro","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Claudio Hawelon","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Irene Nant","Isia Vann","Loreto Bodrogi","Minke Mies","Nils Calixto","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Inga Ferro","Ingrid Barranco","Isande Borrasca","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Marin Onda","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Vira Frente","Axel Calzas","Claudio Hawelon","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Lucas Alcazar","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Isia Vann","Kanon Herrero","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Dante Coginian","Emile Arpa","Isak Baza","Linnea Bergen","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Emile Arpa","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Dante Coginian","Linda Lagos","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adra Nubarron","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Nils Calixto","Ruscella Mies Haber","Vira Frente","Axel Calzas","Isak Baza","Kanon Herrero","Lucas Alcazar","Minke Mies","Sven Flecha","Ada Campo-Corrente","Gustav Cazar","Ingrid Barranco","Irene Nant","Sten Sanjorge Jr","Stenig Fusil","Willem Vasco-Pais","Albina Hafon","Anda Ribera","Carla Forluniau","Claudio Hawelon","Cornelia Lais","Hennie Osvaldo","Isia Vann","Linda Lagos","Mat Bramar","Ruscella Mies Haber","Ada Campo-Corrente","Adra Nubarron","Anda Ribera","Carla Forluniau","Cornelia Lais","Hennie Osvaldo","Inga Ferro","Isia Vann","Linda Lagos","Loreto Bodrogi","Mat Bramar","Minke Mies","Rachel Pantanal","Ada Campo-Corrente","Henk Mies","Ingrid Barranco","Orhan Strum","Willem Vasco-Pais","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Orhan Strum","Varja Lagos","Vira Frente","Isak Baza","Lucas Alcazar","Nils Calixto","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Stenig Fusil","Varro Awelon","Axel Calzas","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Mat Bramar","Valeria Morlun","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Marin Onda","Minke Mies","Stenig Fusil","Ada Campo-Corrente","Inga Ferro","Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Varja Lagos"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"middle","smooth":false},"layout":{"randomSeed":123},"physics":{"stabilization":false}},"groups":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Administration","Engineering","Executive","Facilities","Information Technology","Security"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
Seeing Closeness
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>email_network4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>links</span>, 
                                        vertices <span class='op'>=</span> <span class='va'>nodes_df</span>, 
                                        directed <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'>#email_network4 &lt;- simplify(email_network4)</span>
<span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>width</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/closeness.html'>closeness</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>1000</span>

<span class='va'>nodes3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                     title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>title</span>, 
                     group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>department</span><span class='op'>)</span>,
                     size <span class='op'>=</span> <span class='va'>size</span><span class='op'>)</span>

<span class='co'>#nodes &lt;- nodes[order(nodes$id, decreasing = F),]</span>
<span class='co'>#nodes2$color.highlight.background &lt;- "brown"</span>

<span class='va'>edges3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>email_network4</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>


<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes3</span>, <span class='va'>edges3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span>, 
             nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>,
             selectedBy <span class='op'>=</span> <span class='st'>"group"</span>
             <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLayout.html'>visLayout</a></span><span class='op'>(</span>randomSeed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLegend.html'>visLegend</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Communities based on Weights</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>email_network4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>links</span>, 
                                        vertices <span class='op'>=</span> <span class='va'>nodes_df</span>, 
                                        directed <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>

<span class='va'>w_comm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/cluster_edge_betweenness.html'>edge.betweenness.community</a></span><span class='op'>(</span><span class='va'>email_network4</span>, weights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>

<span class='va'>nodes3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                     title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network4</span><span class='op'>)</span><span class='op'>$</span><span class='va'>title</span>, 
                     group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>w_comm</span><span class='op'>$</span><span class='va'>membership</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>edges3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>email_network4</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>


<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes3</span>, <span class='va'>edges3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span>, 
             nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>,
             selectedBy <span class='op'>=</span> <span class='st'>"group"</span>
             <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-38cbd0086528b83a5528" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-38cbd0086528b83a5528">{"x":{"nodes":{"id":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"title":["SVP/CIO","Truck Driver","Geologist","Truck Driver","Assistant to CFO","Drill Technician","Truck Driver","Facilities Group Manager","Geologist","Drill Technician","Assistant to IT Group Manager","Truck Driver","Truck Driver","Assistant to Security Group Manager","Lead Janitor","Truck Driver","Perimeter Control","Drill Technician","Janitor","Engineer","Security Group Manager","Hydraulic Technician","Truck Driver","Perimeter Control","Site Control","Site Control","SVP/CFO","Truck Driver","IT Technician","Drill Technician","Perimeter Control","Badging Office","Drill Technician","Engineer","Engineering Group Manager","Assistant to COO","IT Group Manager","Site Control","IT Helpdesk","Drill Site Manager","Assistant to CEO","Perimeter Control","IT Technician","SVP/COO","Assistant to CIO","Assistant to Engineering Group Manager","CEO","Building Control","IT Technician","Truck Driver","Badging Office","Janitor","Hydraulic Technician","Environmental Safety Advisor"],"group":["1","2","3","2","4","3","2","2","3","3","4","2","2","4","2","2","4","3","2","3","4","3","2","4","4","4","1","2","5","3","4","4","3","3","3","4","4","4","4","3","4","4","5","1","4","4","1","4","5","2","4","2","3","1"],"label":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"x":[0.457725739198209,0.24812933655745,-0.568574013919157,0.384607095770377,0.615191421681812,-0.612829304242486,0.0733192858129401,0.334766848589897,-1,-0.335975529717642,0.902363176703283,0.139795067513498,0.262317757178087,0.696015048994335,-0.280025306359564,0.274580393093349,-0.121648376818837,-0.397931895027502,-0.0615901861616044,-0.290329259433808,-0.0587282295722511,-0.171986511006593,0.497497472428166,-0.160936559347248,-0.310634048058097,0.0574887424787316,0.376708330829319,0.333807580468477,-0.895648497538686,-0.74773452598218,0.246967704541069,-0.0384463065525047,-0.379424000265689,-0.436518031011822,-0.713178601062546,0.755324358155232,-0.0534354022290472,0.0352752689311391,-0.58026617935912,-0.951516088423863,1,-0.328422368175507,-0.64739340015625,0.52163933765658,0.758267695210321,0.385267727235347,0.425142186829517,-0.0550187300271909,-0.840574679196227,0.574729120012926,-0.0285234249222701,0.293991956974181,-0.361246701290595,0.368653279151735],"y":[0.214202518720763,-0.407863787036684,0.431692672127524,-0.67200662887439,0.450982045647853,0.62124387311786,-0.337639931842231,-0.665725028204894,0.74061900480337,0.711955731230754,0.277829997875772,-0.445253360762138,-0.356224648420495,0.755821464223274,-0.273149791627138,-0.527022957569311,0.337626567573822,0.387937342293311,-0.349961590056984,0.857242958824368,0.0153234159119369,1,-0.272325250786538,0.269475357534248,0.278514090611466,0.310256151354531,0.336513338809725,-0.341258936275741,0.155853136553111,0.622454458234874,0.359939421891831,0.123561907939177,0.777206007361936,0.501256611090296,0.670440364972746,0.539476458483666,-0.102361345407038,0.285427337893212,-0.242117763122288,0.667661003989431,0.178916362487781,0.351678405401137,0.141440044304276,0.260057370190605,0.304028550219752,0.445296609704555,0.092166578455098,0.239521938913704,-0.0350957277368117,-1,0.380360295251702,-0.401120897191173,0.407946302764049,0.218051033505478]},"edges":{"from":["Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Isak Baza","Isak Baza","Isak Baza","Isak Baza","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Sven Flecha","Sven Flecha","Sven Flecha","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais"],"to":["Felix Resumir","Ingrid Barranco","Orhan Strum","Ruscella Mies Haber","Sten Sanjorge Jr","Willem Vasco-Pais","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Axel Calzas","Birgitta Frente","Brand Tempestad","Cecilia Morluniau","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Ruscella Mies Haber","Vira Frente","Adan Morlun","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Rachel Pantanal","Valeria Morlun","Varro Awelon","Carla Forluniau","Cornelia Lais","Gustav Cazar","Henk Mies","Lars Azada","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Valeria Morlun","Adra Nubarron","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Nils Calixto","Varja Lagos","Vira Frente","Adan Morlun","Albina Hafon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Elsa Orilla","Emile Arpa","Felix Resumir","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isak Baza","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Anda Ribera","Cornelia Lais","Felix Balas","Irene Nant","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Ingrid Barranco","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Isia Vann","Linnea Bergen","Rachel Pantanal","Valeria Morlun","Varro Awelon","Anda Ribera","Carla Forluniau","Hideki Cocinaro","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dylan Scozzese","Emile Arpa","Felix Resumir","Henk Mies","Hideki Cocinaro","Irene Nant","Lucas Alcazar","Mat Bramar","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Elsa Orilla","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Edvard Vann","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Henk Mies","Irene Nant","Lucas Alcazar","Marin Onda","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Carla Forluniau","Elsa Orilla","Gustav Cazar","Hennie Osvaldo","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Varja Lagos","Vira Frente","Ada Campo-Corrente","Benito Hawelon","Dante Coginian","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Orhan Strum","Vira Frente","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Edvard Vann","Emile Arpa","Inga Ferro","Irene Nant","Sten Sanjorge Jr","Valeria Morlun","Varro Awelon","Edvard Vann","Felix Balas","Felix Resumir","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Cornelia Lais","Dante Coginian","Edvard Vann","Felix Resumir","Hennie Osvaldo","Inga Ferro","Isande Borrasca","Isia Vann","Kanon Herrero","Minke Mies","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Willem Vasco-Pais","Ada Campo-Corrente","Cecilia Morluniau","Kare Orilla","Loreto Bodrogi","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Orhan Strum","Valeria Morlun","Varro Awelon","Birgitta Frente","Lucas Alcazar","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Hideki Cocinaro","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Claudio Hawelon","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Irene Nant","Isia Vann","Loreto Bodrogi","Minke Mies","Nils Calixto","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Inga Ferro","Ingrid Barranco","Isande Borrasca","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Marin Onda","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Vira Frente","Axel Calzas","Claudio Hawelon","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Lucas Alcazar","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Isia Vann","Kanon Herrero","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Dante Coginian","Emile Arpa","Isak Baza","Linnea Bergen","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Emile Arpa","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Dante Coginian","Linda Lagos","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adra Nubarron","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Nils Calixto","Ruscella Mies Haber","Vira Frente","Axel Calzas","Isak Baza","Kanon Herrero","Lucas Alcazar","Minke Mies","Sven Flecha","Ada Campo-Corrente","Gustav Cazar","Ingrid Barranco","Irene Nant","Sten Sanjorge Jr","Stenig Fusil","Willem Vasco-Pais","Albina Hafon","Anda Ribera","Carla Forluniau","Claudio Hawelon","Cornelia Lais","Hennie Osvaldo","Isia Vann","Linda Lagos","Mat Bramar","Ruscella Mies Haber","Ada Campo-Corrente","Adra Nubarron","Anda Ribera","Carla Forluniau","Cornelia Lais","Hennie Osvaldo","Inga Ferro","Isia Vann","Linda Lagos","Loreto Bodrogi","Mat Bramar","Minke Mies","Rachel Pantanal","Ada Campo-Corrente","Henk Mies","Ingrid Barranco","Orhan Strum","Willem Vasco-Pais","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Orhan Strum","Varja Lagos","Vira Frente","Isak Baza","Lucas Alcazar","Nils Calixto","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Stenig Fusil","Varro Awelon","Axel Calzas","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Mat Bramar","Valeria Morlun","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Marin Onda","Minke Mies","Stenig Fusil","Ada Campo-Corrente","Inga Ferro","Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Varja Lagos"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"middle","smooth":false},"physics":{"stabilization":false}},"groups":["1","2","3","4","5"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["1","2","3","4","5"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='va'>links</span>,vertices <span class='op'>=</span> <span class='va'>nodes_df</span>, directed <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>


<span class='va'>dat_vis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>
<span class='va'>dat_vis</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='va'>dat_vis</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>weight</span>
<span class='va'>dat_vis</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>group</span> <span class='op'>&lt;-</span> <span class='va'>dat_vis</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>department</span>

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span>nodes <span class='op'>=</span> <span class='va'>dat_vis</span><span class='op'>$</span><span class='va'>nodes</span>, edges <span class='op'>=</span> <span class='va'>dat_vis</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-a267c92cad8835d1a845" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-a267c92cad8835d1a845">{"x":{"nodes":{"id":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"title":["SVP/CIO","Truck Driver","Geologist","Truck Driver","Assistant to CFO","Drill Technician","Truck Driver","Facilities Group Manager","Geologist","Drill Technician","Assistant to IT Group Manager","Truck Driver","Truck Driver","Assistant to Security Group Manager","Lead Janitor","Truck Driver","Perimeter Control","Drill Technician","Janitor","Engineer","Security Group Manager","Hydraulic Technician","Truck Driver","Perimeter Control","Site Control","Site Control","SVP/CFO","Truck Driver","IT Technician","Drill Technician","Perimeter Control","Badging Office","Drill Technician","Engineer","Engineering Group Manager","Assistant to COO","IT Group Manager","Site Control","IT Helpdesk","Drill Site Manager","Assistant to CEO","Perimeter Control","IT Technician","SVP/COO","Assistant to CIO","Assistant to Engineering Group Manager","CEO","Building Control","IT Technician","Truck Driver","Badging Office","Janitor","Hydraulic Technician","Environmental Safety Advisor"],"department":["Executive","Facilities","Engineering","Facilities","Administration","Engineering","Facilities","Facilities","Engineering","Engineering","Administration","Facilities","Facilities","Administration","Facilities","Facilities","Security","Engineering","Facilities","Engineering","Security","Engineering","Facilities","Security","Security","Security","Executive","Facilities","Information Technology","Engineering","Security","Security","Engineering","Engineering","Engineering","Administration","Information Technology","Security","Information Technology","Engineering","Administration","Security","Information Technology","Executive","Administration","Administration","Executive","Security","Information Technology","Facilities","Security","Facilities","Engineering","Executive"],"label":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"group":["Executive","Facilities","Engineering","Facilities","Administration","Engineering","Facilities","Facilities","Engineering","Engineering","Administration","Facilities","Facilities","Administration","Facilities","Facilities","Security","Engineering","Facilities","Engineering","Security","Engineering","Facilities","Security","Security","Security","Executive","Facilities","Information Technology","Engineering","Security","Security","Engineering","Engineering","Engineering","Administration","Information Technology","Security","Information Technology","Engineering","Administration","Security","Information Technology","Executive","Administration","Administration","Executive","Security","Information Technology","Facilities","Security","Facilities","Engineering","Executive"],"x":[-0.650440985952004,0.703969426106253,-0.776722203271583,0.601480419999904,0.40403076206605,-0.817571676930427,0.489873492930927,0.629527147355418,-0.666973885413022,-0.61020875231219,0.1635344404662,0.403568373342396,0.175757626201345,0.020367458440339,0.438949040257991,0.769590720462312,0.117588989794521,-0.595761185503501,0.504479678980077,-0.340422393954911,0.100295668401262,-0.561591716099622,0.788328992557493,-0.220997276085013,-0.0570638552247522,-0.131565029206776,-0.485152257740041,0.386523595729748,-0.619271278858277,-0.487942842860015,-0.074638254073718,-0.045496980849644,-0.735790734628661,-0.54590351119337,-0.618343745749638,0.0276388332406203,-0.393009916359774,-0.509503502656443,-0.36500273836815,-0.680088893135482,0.269744573533431,-0.182996270493579,-0.554219562827827,-0.315851525642371,0.106005483034954,-0.118418542271465,-0.232324467677231,-0.133977034262234,-0.705419072680033,1,-0.310569921096137,0.483953657537264,-1,-0.395003004655015],"y":[0.545994926433871,0.567808069134665,-0.589048107190763,0.555351225347752,-0.264601590429222,-0.52936549087173,0.0210716929189718,0.501538318248909,-0.584450735545226,-0.594940999410705,-0.0525573402048635,0.645292559881921,0.844821297952033,-0.00826130113207901,0.217740478649154,0.505508298150205,0.542755979922768,-1,0.181526674521999,-0.352357049532408,0.366558305244377,-0.459185531022713,0.698229619633419,0.237277262583886,0.220478683971611,0.235307171845219,0.673047746243933,0.579276748437759,-0.119473690777083,-0.501395535343049,0.334666988104713,0.443154646276459,-0.47700847035434,-0.683114332809806,-0.757956948095904,-0.0957702776534162,0.0755180413934056,0.426222714639324,-0.0865095542103548,-0.955171216173203,0.0362081607060631,0.0664849552777014,0.1720655298389,0.626083457058208,0.143546943833598,-0.0867051734648371,1,0.372431206116598,0.0552777883360207,0.674188558739889,0.353077905904875,0.408782091698484,-0.400617381562871,0.570793134234211]},"edges":{"from":["Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Isak Baza","Isak Baza","Isak Baza","Isak Baza","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Sven Flecha","Sven Flecha","Sven Flecha","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais"],"to":["Felix Resumir","Ingrid Barranco","Orhan Strum","Ruscella Mies Haber","Sten Sanjorge Jr","Willem Vasco-Pais","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Axel Calzas","Birgitta Frente","Brand Tempestad","Cecilia Morluniau","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Ruscella Mies Haber","Vira Frente","Adan Morlun","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Rachel Pantanal","Valeria Morlun","Varro Awelon","Carla Forluniau","Cornelia Lais","Gustav Cazar","Henk Mies","Lars Azada","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Valeria Morlun","Adra Nubarron","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Nils Calixto","Varja Lagos","Vira Frente","Adan Morlun","Albina Hafon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Elsa Orilla","Emile Arpa","Felix Resumir","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isak Baza","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Anda Ribera","Cornelia Lais","Felix Balas","Irene Nant","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Ingrid Barranco","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Isia Vann","Linnea Bergen","Rachel Pantanal","Valeria Morlun","Varro Awelon","Anda Ribera","Carla Forluniau","Hideki Cocinaro","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dylan Scozzese","Emile Arpa","Felix Resumir","Henk Mies","Hideki Cocinaro","Irene Nant","Lucas Alcazar","Mat Bramar","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Elsa Orilla","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Edvard Vann","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Henk Mies","Irene Nant","Lucas Alcazar","Marin Onda","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Carla Forluniau","Elsa Orilla","Gustav Cazar","Hennie Osvaldo","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Varja Lagos","Vira Frente","Ada Campo-Corrente","Benito Hawelon","Dante Coginian","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Orhan Strum","Vira Frente","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Edvard Vann","Emile Arpa","Inga Ferro","Irene Nant","Sten Sanjorge Jr","Valeria Morlun","Varro Awelon","Edvard Vann","Felix Balas","Felix Resumir","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Cornelia Lais","Dante Coginian","Edvard Vann","Felix Resumir","Hennie Osvaldo","Inga Ferro","Isande Borrasca","Isia Vann","Kanon Herrero","Minke Mies","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Willem Vasco-Pais","Ada Campo-Corrente","Cecilia Morluniau","Kare Orilla","Loreto Bodrogi","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Orhan Strum","Valeria Morlun","Varro Awelon","Birgitta Frente","Lucas Alcazar","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Hideki Cocinaro","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Claudio Hawelon","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Irene Nant","Isia Vann","Loreto Bodrogi","Minke Mies","Nils Calixto","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Inga Ferro","Ingrid Barranco","Isande Borrasca","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Marin Onda","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Vira Frente","Axel Calzas","Claudio Hawelon","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Lucas Alcazar","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Isia Vann","Kanon Herrero","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Dante Coginian","Emile Arpa","Isak Baza","Linnea Bergen","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Emile Arpa","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Dante Coginian","Linda Lagos","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adra Nubarron","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Nils Calixto","Ruscella Mies Haber","Vira Frente","Axel Calzas","Isak Baza","Kanon Herrero","Lucas Alcazar","Minke Mies","Sven Flecha","Ada Campo-Corrente","Gustav Cazar","Ingrid Barranco","Irene Nant","Sten Sanjorge Jr","Stenig Fusil","Willem Vasco-Pais","Albina Hafon","Anda Ribera","Carla Forluniau","Claudio Hawelon","Cornelia Lais","Hennie Osvaldo","Isia Vann","Linda Lagos","Mat Bramar","Ruscella Mies Haber","Ada Campo-Corrente","Adra Nubarron","Anda Ribera","Carla Forluniau","Cornelia Lais","Hennie Osvaldo","Inga Ferro","Isia Vann","Linda Lagos","Loreto Bodrogi","Mat Bramar","Minke Mies","Rachel Pantanal","Ada Campo-Corrente","Henk Mies","Ingrid Barranco","Orhan Strum","Willem Vasco-Pais","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Orhan Strum","Varja Lagos","Vira Frente","Isak Baza","Lucas Alcazar","Nils Calixto","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Stenig Fusil","Varro Awelon","Axel Calzas","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Mat Bramar","Valeria Morlun","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Marin Onda","Minke Mies","Stenig Fusil","Ada Campo-Corrente","Inga Ferro","Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Varja Lagos"],"weight":[2,8,9,1,16,9,11,8,2,8,6,9,14,6,11,9,11,6,2,3,5,1,5,4,2,4,4,4,3,4,2,2,10,14,5,12,7,7,17,6,11,11,2,9,4,13,16,2,2,2,13,13,13,13,2,3,4,3,8,6,5,3,6,10,4,3,3,2,7,7,13,2,7,10,9,5,3,8,3,11,5,9,6,24,24,24,23,24,24,24,25,25,24,25,23,2,3,4,5,2,3,3,3,3,5,1,3,2,10,8,7,7,6,5,9,9,9,10,8,7,19,19,2,1,19,19,19,19,3,8,10,4,5,8,5,7,2,9,2,8,5,3,10,12,7,3,11,5,9,6,10,13,2,1,1,8,7,23,20,2,20,20,20,20,8,5,6,2,4,7,6,7,1,6,2,5,2,1,5,5,14,16,7,2,11,11,8,10,9,13,13,6,3,4,1,5,3,3,3,3,3,4,1,2,9,9,2,6,10,2,6,9,5,10,10,8,10,7,6,4,3,1,2,6,3,4,3,3,2,2,5,4,7,5,6,7,2,4,3,1,6,6,7,5,6,1,4,2,2,2,3,3,2,2,1,2,2,2,2,2,3,1,7,3,4,8,3,5,4,9,6,3,3,4,19,20,2,23,5,16,16,14,18,1,14,3,16,2,17,11,1,1,3,3,3,6,3,4,4,2,2,3,2,2,3,2,1,3,3,1,4,1,2,3,3,1,1,3,6,1,5,2,6,9,2,1,2,2,14,1,2,2,6,6,3,8,7,5,3,9,9,6,8,4,5,2,2,4,2,31,24,31,2,9,5,7,7,5,4,1,10,6,4,8,5,4,3,4,4,2,1,3,2,8,2,3,4,4,6,1,5,1,1,2,5,3,1,3,7,5,1,2,10,7,4,3,1,1,7,3,7,9,3,8,2,12,5,7,7,5,1,4,5,10,5,6,7,8,5,7,5,6,4,5,10,7,6,6,18,18,18,18,18,18,1,1,2,3,3,3,3,1,3,2,5,1,1,5,2,4,3,4,2,4,1,2,3,1,2,40,1,22,30,3,2,2,3,2,2,3,3,2,3,2,2,5,18,18,18,1,18,18,18,3,1,1,4,1,1,2,1,3,2,23,2,31,2,31,6,3,3,2,4,1,11,1,14,14,1,14,2,5,14,14,16,1,2,14,14,14,2,2,2,14,2,14,2,14,20,2,8,11,14,4,8,9,7,4,5,6,6,6,1,5,2,24,20,29,3,3,1,2,2,7,4,5,3,4,2,1,5,1,2,4,6,7,5,5,6,6,5,6,4,7,5,1,2,5,6,5,3,2,5,5,3,5,3,10,2,5,7,4,4,4,5,4,4,1,7,3,2,11,2,4,14,9,1],"value":[2,8,9,1,16,9,11,8,2,8,6,9,14,6,11,9,11,6,2,3,5,1,5,4,2,4,4,4,3,4,2,2,10,14,5,12,7,7,17,6,11,11,2,9,4,13,16,2,2,2,13,13,13,13,2,3,4,3,8,6,5,3,6,10,4,3,3,2,7,7,13,2,7,10,9,5,3,8,3,11,5,9,6,24,24,24,23,24,24,24,25,25,24,25,23,2,3,4,5,2,3,3,3,3,5,1,3,2,10,8,7,7,6,5,9,9,9,10,8,7,19,19,2,1,19,19,19,19,3,8,10,4,5,8,5,7,2,9,2,8,5,3,10,12,7,3,11,5,9,6,10,13,2,1,1,8,7,23,20,2,20,20,20,20,8,5,6,2,4,7,6,7,1,6,2,5,2,1,5,5,14,16,7,2,11,11,8,10,9,13,13,6,3,4,1,5,3,3,3,3,3,4,1,2,9,9,2,6,10,2,6,9,5,10,10,8,10,7,6,4,3,1,2,6,3,4,3,3,2,2,5,4,7,5,6,7,2,4,3,1,6,6,7,5,6,1,4,2,2,2,3,3,2,2,1,2,2,2,2,2,3,1,7,3,4,8,3,5,4,9,6,3,3,4,19,20,2,23,5,16,16,14,18,1,14,3,16,2,17,11,1,1,3,3,3,6,3,4,4,2,2,3,2,2,3,2,1,3,3,1,4,1,2,3,3,1,1,3,6,1,5,2,6,9,2,1,2,2,14,1,2,2,6,6,3,8,7,5,3,9,9,6,8,4,5,2,2,4,2,31,24,31,2,9,5,7,7,5,4,1,10,6,4,8,5,4,3,4,4,2,1,3,2,8,2,3,4,4,6,1,5,1,1,2,5,3,1,3,7,5,1,2,10,7,4,3,1,1,7,3,7,9,3,8,2,12,5,7,7,5,1,4,5,10,5,6,7,8,5,7,5,6,4,5,10,7,6,6,18,18,18,18,18,18,1,1,2,3,3,3,3,1,3,2,5,1,1,5,2,4,3,4,2,4,1,2,3,1,2,40,1,22,30,3,2,2,3,2,2,3,3,2,3,2,2,5,18,18,18,1,18,18,18,3,1,1,4,1,1,2,1,3,2,23,2,31,2,31,6,3,3,2,4,1,11,1,14,14,1,14,2,5,14,14,16,1,2,14,14,14,2,2,2,14,2,14,2,14,20,2,8,11,14,4,8,9,7,4,5,6,6,6,1,5,2,24,20,29,3,3,1,2,2,7,4,5,3,4,2,1,5,1,2,4,6,7,5,5,6,6,5,6,4,7,5,1,2,5,6,5,3,2,5,5,3,5,3,10,2,5,7,4,4,4,5,4,4,1,7,3,2,11,2,4,14,9,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"middle"},"physics":{"stabilization":false}},"groups":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
<h2 id="insights">5 Insights</h2>
<h3 id="question-1">5.1 Question 1</h3>
<p>Characterising News Sources <br></p>
<p>Using the <code>TextNet</code> package, the news sources have be clustered as shown below based on the shared words.</p>
<p>The news sources “Tethys News”, “Centrum Sentinel” and “Modern Rubicon” have been excluded from this as they largely only reported in 2014(kidnappings) and might skew the data.</p>
<p>Similar news sources are colored as shown below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-1.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-1.png" width="418" /></p>
</div>
<p>Average Length of Words</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-2.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-2.png" width="974" /></p>
</div>
<p>TF-IDF</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-3.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-3.png" width="605" /></p>
</div>
<p>Using TF-IDF, we can see:</p>
<p>Cluster 1: Across the news sources, the most relevant words are related to the people of Elodis. Cluster 2: Across the news sources, the most relevant words are related to the designer drug situation in Abila. Cluster 3: Across the news sources, the most relevant words are related to the arrest details/protest situations. Cluster 4: Across the news sources, the most relevant words are related to the designer drug situation in Abila. Cluster 5: Across the news sources, the most relevant words are related to the GasTech and the industry.</p>
<p>Centrality</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-4.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-4.png" width="372" /></p>
</div>
<p>What are the relationships between the primary and derivative sources?</p>
<p>The chart flows below are extracted events that have occurred surrounding GasTech (Hank Fluss’s death), APA (Drug dealings) and POK (arrests).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-5.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-5.png" width="800" /></p>
</div>
<p>We can see that Who What News derives the news article from The World. This is evident from the retention of the world “Centrum”. News Online Today as we shall also see in the following analysis are a collection of all the primary new sources. This explains the high betweeness of the node.</p>
<p>The Light of Truth, The General Post and The Tulip are all derivative sources are they not only posted some time later, but also are in fact translations of the original article posted. There might be double translations happening as there is meaning lost.</p>
<p>For e.g. in the texts highlighted in purple, we can see that Centrum, a place in Tethys, has become translated/doubble translated into “centrum of the company” or "center of the company. This also possibly implies that The Tupli and The General Post might be printed/derived from the same language.</p>
<p>The word “wildcatters”, highlighted in green, tells us the Light of Truth, the General Post and The Tulip are all derived from The World as it only appears in that news article.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-9.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-9.png" width="908" /></p>
</div>
<p>Hence the primary source in this cluster is <em>The World</em>.</p>
<p>The chart below shows the links between the news sources during the arrests at the Tiskele River in 2005.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-6.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-6.png" width="800" /></p>
</div>
<p>The first documentation of the arrests was noted on the 5th of April 2005 by Homeland Illumination with a specific number 15. The second document of the event was done by International News with more specific capturing of events but give a vague number of “more than a dozen”.</p>
<p>Once that is identified, we can see that within a community, the new sources derive from the primary source. In this case, the primary source is Kronos Star for Community 2 and Homeland Illumination for Community 1.</p>
<p>While Kronos Star and International News was published on the same day, Kronos Star is the primary. (PROVED).</p>
<p>Community 1: News Online Today is short re-write of the article written by Kronos Star, while International News is a longer write-up. The statement by Gastech Spokesman, Rufus Dyrmasi is not included.</p>
<p>Worldwide, The Guide and The Truth are translated/double translated derivations of article by Kronos Star. This is evident from the tranlations of the Tiskele bend highlighted on purple.</p>
<p>Community 2: All News Today is derivation of Homeland Illumination, a re-write.</p>
<p>The Orb and the Wrap and translations of Homeland Illuminations versions. This is evident from the “Tiskele bend” being converted into “curve of Tiskele” and “bending Tiskele”. They might be different languages. The Daily Pegasus is also a derived source of Homeland Illumination due to use of the term “pre-dawn” that is not in both The Orb and The Wrap.</p>
<p>For many such articles, community 1 and 2 are linked.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-7.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-7.png" width="800" /></p>
</div>
<p>In 2011, POK was declared as a public threat by the Government of Kronos.</p>
<p>Community 2 and Community 3 reported on that event.</p>
<p>Like discussed previously Community 2’s primary source is Kronos Star. For Community 3, Abila Post is.</p>
<p>As an add-on, The Guide, The Truth and Worldwise are translations.</p>
<p>Community 3: Central Bulletin, News Desk and The Explainer are derivative sources. This is evident from the phrase, “A shop owner in the Siopa district”.</p>
<p>Central Bulletin is a re-write as the grammatical correctness of the phrase “A Shop Owner in the Siopa district” is preserved in addition to other terms.</p>
<p>The derivative sources are: Central Bulletin, News Desk, The Explainer and Athena Speaks. However, The Explainer manages to retain much of the original meaning.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-8.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-8.png" width="2200" /></p>
</div>
<p>Community 5’s primary source is International Times, as it was the first to publish the article on the drug situation in Abila.</p>
<p>As discussed previously, News Online Today, likely an online source, is a short re-write of the article. The other news sources, The Continent, Everyday News, World Journal are translations of the original article,</p>
<h3 id="question-2">5.2 Question 2</h3>
<p>Using Latent Dichrelet Allocations, we have identified the following topics in the different clusters found above.</p>
<p>We can get a general idea of the topics that each of the clusters covers:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-6-1.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-6-1.png" width="348" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-10.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-10.png" width="414" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-6-2.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-6-2.png" width="349" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-11.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-11.png" width="466" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-6-3.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-6-3.png" width="348" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-12.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-12.png" width="463" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-6-4.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-6-4.png" width="340" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-13.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-13.png" width="496" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-6-5.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-6-5.png" width="348" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-1-14.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-1-14.png" width="466" /></p>
</div>
<h3 id="question-3">5.3 Question 3</h3>
<h3 id="question-4">5.4 Question 4</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
